<?xml version="1.0" encoding="utf-8"?>
<ArcGIS defaultAssembly="ArcGIS.Desktop.Metadata.dll" defaultNamespace="ArcGIS.Desktop.Metadata" xmlns="http://schemas.esri.com/DADF/Registry" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://schemas.esri.com/DADF/Registry \ArcGIS\ArcGISDesktop\UIFramework\ArcGIS.Desktop.Framework.xsd">

  <dependencies>
    <dependency name="ADCore.daml" />
  </dependencies>
  
  <modules>
    <insertModule id="esri_metadata_module" className="MetadataModule" autoLoad="false">
      <panes>
        <pane id="esri_metadata_metadataPane" caption="Metadata" className="MetadataEditPaneViewModel" smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/MetadataEdit16.png" isClosable="true" defaultTab="esri_metadata_metadataTab" isDropTarget="false">
          <content className="MetadataEditPaneView" />
        </pane>
      </panes>

      <tabs>
        <tab id="esri_metadata_metadataTab" caption="Metadata" condition="esri_metadata_metadataEditingPane" placeWith="esri_core_insertTab" insert="before" keytip="M">
          <group refID="esri_metadata_clipboardGroup"/>
          <group refID="esri_metadata_metadataEditingGroup" />
        </tab>
      </tabs>

      <groups>     
        <group id="esri_metadata_metadataEditingGroup" caption="Manage Metadata" smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/MetadataDocument32.png">
          <button refID="esri_metadata_save" size="large" />
          <button refID="esri_metadata_apply" size="large" />
        </group>
        <group id="esri_metadata_clipboardGroup" caption="Clipboard" keytip="CG" smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/EditPaste16.png">
          <button refID="esri_core_editPasteButton" />
          <button refID="esri_core_editCutButton" size="middle" />
          <button refID="esri_core_editCopyButton" size="middle" />
        </group>
      </groups>
      <controls>
        <button id="esri_metadata_cancel" className="esri_metadata_module:OnMetadataEditCancel" loadOnClick="false" caption="Close" extendedCaption="Stop editing metadata for the selected item; on ribbon" keytip="CL" condition="esri_metadata_metadataEditing" smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/GenericCancel32.png">
          <tooltip heading="">Stop editing the item's metadata. Do not save any changes.</tooltip>
        </button>
        <button id="esri_metadata_save" className="MetadataSaveCmd" loadOnClick="false" caption="Save" extendedCaption="Save changes to the selected item's metadata; on ribbon" condition="esri_metadata_metadataEditing"
                     keytip="SV" smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/GenericSave32.png">
          <tooltip heading="">Save all edits made since the last save. After saving, you cannot undo previous metadata edits.</tooltip>         
        </button>
        <button id="esri_metadata_apply" className="MetadataApplyCmd" loadOnClick="false" caption="Apply" extendedCaption="Apply changes to the selected item's metadata; on ribbon" condition="esri_metadata_metadataEditing"
                     keytip="A" smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/MetadataApply32.png">
          <tooltip heading="">Apply all metadata edits to the item stored within the project. Metadata edits aren’t saved until changes made to the project are saved.</tooltip>
        </button>
        <button id="esri_metadata_edit"  className="esri_metadata_module:OnMetadataEdit" loadOnClick="false" caption="Edit" extendedCaption="Start editing metadata for the selected item; on ribbon"  condition="esri_metadata_editMetadata" keytip="E"
                largeImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/GenericPencil32.png"
                smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/GenericPencil16.png">
          <tooltip heading="">Start editing the item's metadata.
          <disabledText>Editing metadata is enabled when you have write access to local items, you own the portal item, or when a map layer or table has its own metadata.</disabledText>
          </tooltip>
        </button>

        <button id="esri_metadata_import_currentStyle" className="MetadataImportCurrentStyleCmd" loadOnClick="false" caption="Current Metadata Style" extendedCaption="Import metadata using current metadata style; on ribbon" condition="esri_metadata_editMetadata"
                keytip="IMC" >
          <tooltip heading="">Import metadata using current metadata style.</tooltip>
        </button>
        
        <button id="esri_metadata_import_ISO19115_19139" className="MetadataImportISO19115_19139Cmd" loadOnClick="false" caption="ISO 19115/19139" extendedCaption="Import ISO 19115/19139 format metadata; on ribbon" condition="esri_metadata_editMetadata"
                keytip="IM139" >
          <tooltip heading="">Import ISO 19115/19139 format metadata.</tooltip>
        </button>

        <button id="esri_metadata_import_ISO19115_1_3" className="MetadataImportISO19115_1_3Cmd" loadOnClick="false" caption="ISO 19115-1/19115-3" extendedCaption="Import ISO 19115-1/19115-3 format metadata; on ribbon" condition="esri_metadata_editMetadata"
                keytip="IM-1" >
          <tooltip heading="">Import ISO 19115-1/19115-3 format metadata.</tooltip>
        </button>

        <button id="esri_metadata_import_ISO19115_2" className="MetadataImportISO19115_2Cmd" loadOnClick="false" caption="ISO 19115_2" extendedCaption="Import ISO 19115-2 format metadata; on ribbon" condition="esri_metadata_editMetadata"
                keytip="IM_2" >
          <tooltip heading="">Import ISO 19115-2 format metadata.</tooltip>
        </button>

        <button id="esri_metadata_import_FGDC" className="MetadataImportFGDCCmd" loadOnClick="false" caption="FGDC CSDGM" extendedCaption="Import FGDC CSDGM format metadata; on ribbon" condition="esri_metadata_editMetadata"
                keytip="IMF" >
          <tooltip heading="">Import FGDC CSDGM format metadata.</tooltip>
        </button>
        
        <button id="esri_metadata_export_currentStyle" className="MetadataExportCurrentStyleCmd" loadOnClick="false" caption="Current Metadata Style" extendedCaption="Export metadata of current style; on ribbon" condition="esri_metadata_itemsHaveMetadata"
                keytip="EXC" >
          <tooltip heading="">Export metadata of current style.</tooltip>
        </button>

        <button id="esri_metadata_export_ISO19115_19139" className="MetadataExportISO19115_19139Cmd" loadOnClick="false" caption="ISO 19115/19139" extendedCaption="Export ISO 19115/19139 format metadata; on ribbon" condition="esri_metadata_itemsHaveMetadata"
                keytip="EX139" >
          <tooltip heading="">Export ISO 19115/19139 format metadata.</tooltip>
        </button>

        <button id="esri_metadata_export_ISO19115_1_3" className="MetadataExportISO19115_1_3Cmd" loadOnClick="false" caption="ISO 19115-1/19115-3" extendedCaption="Export ISO 19115-1/19115-3 format metadata; on ribbon" condition="esri_metadata_itemsHaveMetadata"
                keytip="EX-1" >
          <tooltip heading="">Export ISO 19115-1/19115-3 format metadata.</tooltip>
        </button>

        <button id="esri_metadata_export_ISO19115_2" className="MetadataExportISO19115_2Cmd" loadOnClick="false" caption="ISO 19115_2" extendedCaption="Export ISO 19115-2 format metadata; on ribbon" condition="esri_metadata_itemsHaveMetadata"
                keytip="EX_2" >
          <tooltip heading="">Export ISO 19115-2 format metadata.</tooltip>
        </button>

        <button id="esri_metadata_export_FGDC" className="MetadataExportFGDCCmd" loadOnClick="false" caption="FGDC CSDGM" extendedCaption="Export FGDC CSDGM format metadata; on ribbon" condition="esri_metadata_itemsHaveMetadata"
                keytip="EXF" >
          <tooltip heading="">Import FGDC CSDGM format metadata.</tooltip>
        </button>
        
        <button id="esri_metadata_validate_currentStyle" className="MetadataValidateCurrentStyleCmd" loadOnClick="false" caption="Current Metadata Style" extendedCaption="Validate metadata using current style; on ribbon" condition="esri_metadata_metadataEditing"
                keytip="VMC" >
          <tooltip heading="">Validate metadata using current style.</tooltip>
        </button>

        <button id="esri_metadata_validate_ISO19115_19139" className="MetadataValidateISO19115_19139Cmd" loadOnClick="false" caption="ISO 19115/19139" extendedCaption="Validate ISO 19115/19139 format metadata; on ribbon" condition="esri_metadata_metadataEditing"
                keytip="VM139" >
          <tooltip heading="">Validate ISO 19115/19139 format metadata.</tooltip>
        </button>

        <button id="esri_metadata_validate_ISO19115_1_3" className="MetadataValidateISO19115_1_3Cmd" loadOnClick="false" caption="ISO 19115-1/19115-3" extendedCaption="Validate ISO 19115-1/19115-3 format metadata; on ribbon" condition="esri_metadata_metadataEditing"
                keytip="VM-1" >
          <tooltip heading="">Validate ISO 19115-1/19115-3 format metadata.</tooltip>
        </button>

        <button id="esri_metadata_validate_ISO19115_2" className="MetadataValidateISO19115_2Cmd" loadOnClick="false" caption="ISO 19115_2" extendedCaption="Validate ISO 19115-2 format metadata; on ribbon" condition="esri_metadata_metadataEditing"
                keytip="VM_2" >
          <tooltip heading="">Validate ISO 19115-2 format metadata.</tooltip>
        </button>

        <button id="esri_metadata_validate_FGDC" className="MetadataValidateFGDCCmd" loadOnClick="false" caption="FGDC CSDGM" extendedCaption="Validate FGDC CSDGM format metadata; on ribbon" condition="esri_metadata_metadataEditing"
                keytip="VMF" >
          <tooltip heading="">Validate FGDC CSDGM format metadata.</tooltip>
        </button>

        <button id="esri_metadata_copyFrom" className="MetadataCopyFromCmd" loadOnClick="false" caption="Copy From" extendedCaption="Copy metadata from selected item; on ribbon" condition="esri_metadata_editMetadata"
                     keytip="CF" smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/EditCopy16.png">
          <tooltip heading="">Copy metadata from.</tooltip>
        </button>

        <button id="esri_metadata_saveAs_html" className="MetadataSaveAsHTMLCmd" loadOnClick="false" caption="Display As HTML" extendedCaption="Save the current metadata display as HTML; on ribbon" condition="esri_metadata_itemsHaveMetadata"
                keytip="SH" >
          <tooltip heading="">Save the current metadata display as HTML.</tooltip>
        </button>

        <button id="esri_metadata_saveAs_xml_exact" className="MetadataSaveAsXMLCmd" loadOnClick="false" caption="Content As XML File" extendedCaption="Save the current metadata as XML file; on ribbon" condition="esri_metadata_itemsHaveMetadata"
                keytip="SX" >
          <tooltip heading="">Save the current metadata as XML file.</tooltip>
        </button>

        <button id="esri_metadata_saveAs_xml_removeName" className="MetadataSaveAsXMLRemoveMachineNamesCmd" loadOnClick="false" caption="Remove Machine Names" extendedCaption="Save the current metadata as XML file and remove machine names; on ribbon" condition="esri_metadata_itemsHaveMetadata"
                keytip="SXN" >
          <tooltip heading="">Save the current metadata as XML file and remove machine names.</tooltip>
        </button>

        <button id="esri_metadata_saveAs_xml_removeSensitive" className="MetadataSaveAsXMLRemoveSensitiveInfoCmd" loadOnClick="false" caption="Remove All Sensitive" extendedCaption="Save the current metadata display as XML file and remove all sensitive information; on ribbon" condition="esri_metadata_itemsHaveMetadata"
                keytip="SXS" >
          <tooltip heading="">Save the current metadata display as XML file and remove all sensitive information.</tooltip>
        </button>

        <button id="esri_metadata_saveAs_template" className="MetadataSaveAsTemplateCmd" loadOnClick="false" caption="Metadata Template" extendedCaption="Save only the metadata that the user typed in as XML; on ribbon" condition="esri_metadata_itemsHaveMetadata"
                keytip="ST" >
          <tooltip heading="">Save only the metadata that the user typed in as XML.</tooltip>
        </button>       

      </controls>

      <menus>
        <menu id="esri_metadata_import" caption="Import" keytip="Import metadata"
              smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/GenericImport16.png"
              largeImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/GenericImport32.png">
          <tooltip heading="Import">
            Replace the current metadata content with content from another ArcGIS item or a standard-format XML file.

When importing an FGDC- or ISO 19139-format XML file, the content is converted to the ArcGIS Metadata format, and then merged with the item's existing meatdata. Existing ArcGIS-specific content such as the item's thumbnail and geoprocessing history are not replaced.
            <disabledText>Importing metadata is enabled when you have write access to local items, you own the portal item, or when a map layer or table has its own metadata.</disabledText>
          </tooltip>
          <button refID="esri_metadata_import_currentStyle" />
          <button refID="esri_metadata_import_ISO19115_19139"  separator="true" />
         <!--  <button refID="esri_metadata_import_ISO19115_1_3"/>
          <button refID="esri_metadata_import_ISO19115_2"/> -->
          <button refID="esri_metadata_import_FGDC" separator="true"/>
        </menu>

        <menu id="esri_metadata_saveAs" caption="Save As" keytip="Save metadata as"
              smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/EditingSaveEdits_B_16.png"
              largeImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/EditingSaveEdits_B_32.png">
          <tooltip heading="Save As">
            Save the current item's metadata as.
          </tooltip>
          <button refID="esri_metadata_saveAs_html"/>
          <button refID="esri_metadata_saveAs_xml_exact" separator="true"/>
          <button refID="esri_metadata_saveAs_xml_removeName"/>
          <button refID="esri_metadata_saveAs_xml_removeSensitive"/>
          <button refID="esri_metadata_saveAs_template" separator="true"/>
        </menu>

        <menu id="esri_metadata_validate" caption="Validate" keytip="Validate metadata"
              smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/GenericCheckMark16.png"
              largeImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/GenericCheckMark32.png">
          <tooltip heading="Validate">
             Check if the item's metadata is valid according to a metadata standard's XML Schema or XML DTD. The item's metadata is exported to a standard format and validated as determined by the current ArcGIS Metadata Style.
          </tooltip>
          <button refID="esri_metadata_validate_currentStyle"/>
          <button refID="esri_metadata_validate_ISO19115_19139" separator="true"/>
          <button refID="esri_metadata_validate_ISO19115_1_3"/>
          <button refID="esri_metadata_validate_ISO19115_2"/>
          <button refID="esri_metadata_validate_FGDC" separator="true"/>
        </menu>

        <menu id="esri_metadata_export" caption="Export" keytip="Export metadata"
              smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/GenericExport16.png"
              largeImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/GenericExport32.png">
          <tooltip heading="Export">
            Export the item's metadata to a standard-format XML file. The XML format, such as FGDC- or ISO 19139-format, is determined by the current ArcGIS Metadata Style.
          </tooltip>
          <button refID="esri_metadata_export_currentStyle"/> 
          <button refID="esri_metadata_export_ISO19115_19139" separator="true"/>
          <!-- <button refID="esri_metadata_export_ISO19115_1_3"/>
          <button refID="esri_metadata_export_ISO19115_2"/>  -->
          <button refID="esri_metadata_export_FGDC" separator="true"/>
        </menu>
      </menus>

    </insertModule>

    <updateModule refID="esri_core_module">
      <tabs>
        <updateTab refID="esri_core_homeTab">
          <insertGroup refID="esri_metadata_metadataViewGroup" placeWith="esri_core_organize" insert="after" />
        </updateTab>
      </tabs>

      <groups>
        <insertGroup id="esri_metadata_metadataViewGroup" caption="Metadata" smallImage="pack://application:,,,/ArcGIS.Desktop.Resources;component/Images/MetadataDocument16.png">
          <button refID="esri_metadata_edit" size="large" />

          <menu refID="esri_metadata_import" size="middle" /> 
          <button refID="esri_metadata_copyFrom" size="middle" />
          <menu refID="esri_metadata_saveAs" size="middle" />

          <!-- <menu refID="esri_metadata_validate" size="middle" /> -->
          <menu refID="esri_metadata_export" size="middle" />
        </insertGroup>
      </groups>

    </updateModule>

  </modules>

  <propertySheets>
    <updateSheet refID="esri_core_optionsPropertySheet">
      <insertPage id="esri_metadata_MetadataOptionsPropertyPage" caption="Metadata" className="MetadataOptionsViewModel" group="Application"
                  insert="after" placeWith="esri_mapping_CadOptionsPropertyPage">
        <content className="MetadataOptionsView" />
      </insertPage>
    </updateSheet>
  </propertySheets>

  <conditions>
    <insertCondition id="esri_metadata_metadataEditingPane" caption="No panes active">
      <and>
        <state id="esri_metadata_metadataEditing" />
        <state id="esri_metadata_metadataPane" />
      </and>
    </insertCondition>
    <insertCondition id="esri_metadata_editMetadata" caption="No panes active">
      <and>
        <state id="esri_metadata_canEditMetadata" />
        <state id="esri_core_resourcesPane" />
      </and>
    </insertCondition>
    <insertCondition id="esri_metadata_itemsHaveMetadata" caption="No panes active">
      <and>
        <state id="esri_metadata_hasMetadata" />
        <state id="esri_core_resourcesPane" />
      </and>
    </insertCondition>
    <insertCondition id="esri_metadata_printMetadata" caption="No panes active">
      <and>
        <state id="esri_metadata_editMetadata" />
        <state id="esri_core_projectView_details" />
        <not>
          <state id="esri_metadata_metadataEditing" />
        </not>
      </and>
    </insertCondition>
  </conditions>

  <categories>
    <insertCategory id="esri_metadata_metadataEditors">
      <insertComponent id="esri_metadata_metadataEditor_fgdc" className="FGDCMetadataEditor">
        <content type="FGDC" displayName="FGDC CSDGM Metadata">
          <metadataConfig ArcGISProfile="FGDC" ValidatePages="True">
            <validationNamespaceURI>metadata</validationNamespaceURI>
            <validationSchemaURL>http://www.fgdc.gov/schemas/metadata/fgdc-std-001-1998.dtd</validationSchemaURL>
            <tranformStyle>FGDC</tranformStyle>
            <viewerXslt>Metadata\Stylesheets\ArcGISProFull.xsl</viewerXslt>
            <editor>
              <forms>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Overview">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ItemInfo">
                    <validation>

                      <!-- title -->
                      <exists xpath="/metadata/dataIdInfo/idCitation/resTitle[. != '']" ref="resTitle"/>

                      <!-- abstract -->
                      <for xpath="/metadata[not(tool)]">
                        <exists xpath="dataIdInfo/idAbs[. != '']" ref="idAbs"/>
                      </for>

                      <!-- tool summary -->
                      <for xpath="/metadata[tool]">
                        <exists xpath="tool/summary[. != '']" ref="toolSummary"/>
                      </for>

                      <!-- tools -->
                      <for xpath="//scriptExample">
                        <exists xpath="title[. != '']" ref="scriptTitle"/>
                      </for>

                      <!-- extent -->
                      <!-- FGDC: a bounding box is required no matter what the 'scope' -->
                      <exists xpath="//dataExt//GeoBndBox[*]" ref="dataExtBBoxReq_FGDC"/>

                      <for xpath="//dataExt//GeoBndBox[*][1]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- FGDC: purpose -->
                      <for xpath="/metadata[not(tool)]">
                        <exists xpath="dataIdInfo/idPurp[. != '']" ref="idPurp"/>
                      </for>

                      <!-- FGDC: a topic, keyword or tag is required -->
                      <exists xpath="//dataIdInfo[tpCatBag/*/@value='True' or themeKeys/bag != '' or searchKeys/bag != '']" ref="tagTopicKeyword"/>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Keywords">
                    <validation>

                      <!-- FGDC: a topic, keyword or tag is required -->
                      <exists xpath="//dataIdInfo[tpCatBag/*/@value='True' or themeKeys/bag != '' or searchKeys/bag != '']" ref="tagTopicKeyword"/>

                      <!-- theme keywords -->
                      <for xpath="/metadata/dataIdInfo/themeKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,themeKeywords"/>
                      </for>
                      <!-- place keywords -->
                      <for xpath="/metadata/dataIdInfo/placeKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,placeKeywords"/>
                      </for>
                      <!-- temporal keywords -->
                      <for xpath="/metadata/dataIdInfo/tempKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,temporalKeywords"/>
                      </for>
                      <!-- stratum keywords -->
                      <for xpath="/metadata/dataIdInfo/stratKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,stratumKeywords"/>
                      </for>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//thesaName/citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//thesaName/citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//thesaName/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//thesaName//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- FGDC: keyword thesaurus citation titles and dates are optional
            <for xpath="//thesaName[resTitle | date]">
              <exists xpath="resTitle[. != '']" ref="resTitle"/>
              <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>             
            </for>
             -->
                      <for xpath="//thesaName//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <for xpath="//thesaName//identAuth[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DatasetCitation">
                    <validation>

                      <!-- citation -->
                      <!-- title and date required for main citation - FGDC rules -->
                      <for xpath="//idCitation[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <!-- FGDC: publication date is required -->
                        <exists xpath="date/pubDate[. != '']" ref="pubDate"/>
                      </for>
                      <!-- FGDC: series - both name and issue identifier required -->
                      <for xpath="//datasetSeries[* != '']">
                        <exists xpath="self::*[seriesName != '' and issId != '']" ref="datasetSeries seriesName,seriesName issId,issId"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//dataIdInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//idCitation/citId[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation identifier authority citation -->
                      <!-- title and date required - ISO rules since FGDC doesn't have identifiers -->
                      <for xpath="//idCitation/citId/identAuth[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!-- identifier citation contacts -->
                      <!-- contact name, org or role -->
                      <for xpath="//idCitation/citId/identAuth/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//idCitation/citId/identAuth/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceCitationContacts">
                    <validation>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- FGDC: an 'originator' is required -->
                      <exists xpath="//idCitation/citRespParty[role/RoleCd/@value = '006']" ref="originator"/>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ContactManager"></page>
                </section>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Metadata">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataDetails">
                    <validation>
                      <!-- date stamp is required -->
                      <exists xpath="/metadata/mdDateSt[. != '']" ref="mdDateSt"/>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataContacts">
                    <validation>

                      <!-- one contact requried -->
                      <exists xpath="/metadata[mdContact]" ref="mdContact"/>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//mdContact">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//mdContact">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//mdContact/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataMaintenance">
                    <validation>

                      <for xpath="//mdMaint">

                        <!-- maintentance frequency -->
                        <for xpath="maintFreq">
                          <exists xpath="MaintFreqCd[@value != '']" ref="maintFreq"/>
                        </for>

                        <!-- maintenance scope -->
                        <for xpath="maintScp">
                          <exists xpath="ScopeCd[@value != '']" ref="scopeCd"/>
                        </for>
                      </for>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//mdMaint/maintCont">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//mdMaint/maintCont[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//mdMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>

                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataConstraints">
                    <validation>
                      <!-- classification code -->
                      <for xpath="//mdConst/SecConsts">
                        <exists xpath="class/ClasscationCd[@value != '']" ref="ClasscationCd"/>
                        <!-- FGDC: additional constraints -->
                        <exists xpath="classSys[. != '']" ref="classSys"/>
                        <exists xpath="handDesc[. != '']" ref="handDesc"/>
                      </for>
                      <!-- if the 'other contraints' code is used, then the other contraints tag is required -->
                      <for xpath="//mdConst/LegConsts[*/RestrictCd/@value = '008']">
                        <exists xpath="othConsts[. != '']" ref="othConsts"/>
                      </for>
                      <!-- use constraint is required in the general class -->
                      <!-- FGDC: not required
            <for xpath="//mdConst/Consts">
              <exists xpath="useLimit[. != '']" ref="useLimit"/>  
            </for>
            -->
                    </validation>
                  </page>
                </section>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Resource">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceDetails">
                    <validation>

                      <!-- FGDC: status code is required -->
                      <for xpath="metadata">
                        <exists xpath="dataIdInfo/idStatus/ProgCd[@value != '']" ref="ProgCd"/>
                      </for>

                      <!-- FGDC: spatial rep type required if content provided in spatial data representation page -->
                      <for xpath="/metadata[(//spatRepInfo/VectSpatRep/geometObjs/geoObjCnt != '') or ((//spatRepInfo/Georect/axisDimension/dimSize != '') and ((//spatRepInfo/Georect/axisDimension/@type = '001') or (//spatRepInfo/Georect/axisDimension/@type = '002') or (//spatRepInfo/Georect/axisDimension/@type = '003')))]">
                        <exists xpath="dataIdInfo/spatRpType/SpatRepTypCd[@value != '']" ref="SpatRepTypCd"/>
                      </for>

                      <!-- language of the dataset is mandatory as long as the hierarchy level code != service -->
                      <!--  not for FGDC
            <for xpath="/metadata[mdHrLv/ScopeCd/@value != '014']">
              <exists xpath="//dataIdInfo/dataLang/languageCode[@value != '']" ref="languageCode"/>
            </for>
			-->

                      <!-- scale -->
                      <for xpath="//dataIdInfo//scaleDist[value != '']">
                        <exists xpath="value[@uom != '']" ref="uom,@uom"/>
                      </for>

                      <!-- format name and version -->
                      <for xpath="//dsFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>

                      <!-- browse file name -->
                      <for xpath="//graphOver">
                        <exists xpath="bgFileName[. != '']" ref="bgFileName"/>
                        <!-- FGDC: these also required -->
                        <exists xpath="bgFileDesc[. != '']" ref="bgFileDesc"/>
                        <exists xpath="bgFileType[. != '']" ref="bgFileType"/>
                      </for>

                      <!-- spec usage -->
                      <for xpath="//idSpecUse">
                        <exists xpath="specUsage[. != '']" ref="specUsage"/>
                      </for>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//idSpecUse/usrCntInfo">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//idSpecUse/usrCntInfo[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//idSpecUse/usrCntInfo/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceExtent">
                    <validation>

                      <!-- FGDC: a temporal extent period or instant is required -->
                      <for xpath="/metadata">
                        <exists xpath="dataIdInfo/dataExt[tempEle//* != '']" ref="temporalReq"/>
                      </for>

                      <!-- FGDC: a description is required if a temporal extent is used -->
                      <for xpath="//dataIdInfo/dataExt[tempEle]">
                        <exists xpath="exDesc[. != '']" ref="exDesc,.,tempEle_exDesc"/>
                      </for>

                      <!-- FGDC: a bounding box is required no matter what the 'scope' -->
                      <exists xpath="//dataExt//GeoBndBox[*]" ref="dataExtBBoxReq_FGDC"/>

                      <for xpath="//dataExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//dataExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>
                      <for xpath="//dataExt//vertEle[* != '']">
                        <exists xpath="self::*[vertMinVal &lt; vertMaxVal]" ref="vertMinMaxVal vertMinVal,vertMinVal vertMaxVal,vertMaxVal"/>
                      </for>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//dataExt//GeoDesc//citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//dataExt//GeoDesc//citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataExt//GeoDesc//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//dataExt//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//dataExt//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dataExt//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourcePoc">
                    <validation>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//dataIdInfo/idPoC">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//dataIdInfo/idPoC[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataIdInfo/idPoC/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceMaintenance">
                    <validation>

                      <for xpath="//resMaint">

                        <!-- maintentance frequency
              FDGC: see the global rule below
              
              <for xpath="maintFreq">
                <exists xpath="MaintFreqCd[@value != '']" ref="maintFreq"/>  
              </for>     
              -->

                        <!-- maintenance scope -->
                        <for xpath="maintScp">
                          <exists xpath="ScopeCd[@value != '']" ref="scopeCd"/>
                        </for>
                      </for>

                      <!-- FGDC: frequency is always required -->
                      <exists xpath="/metadata/dataIdInfo/resMaint/maintFreq/MaintFreqCd[@value != '']" ref="maintFreq"/>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//resMaint/maintCont">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//resMaint/maintCont[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//resMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceConstraints">
                    <validation>
                      <!-- classification code -->
                      <for xpath="//resConst/SecConsts">
                        <exists xpath="class/ClasscationCd[@value != '']" ref="ClasscationCd"/>
                        <!-- FGDC: additional constraints -->
                        <exists xpath="classSys[. != '']" ref="classSys"/>
                        <exists xpath="handDesc[. != '']" ref="handDesc"/>
                      </for>
                      <!-- if the 'other contraints' code is used, then the other contraints tag is required -->
                      <for xpath="//resConst/LegConsts[*/RestrictCd/@value = '008']">
                        <exists xpath="othConsts[. != '']" ref="othConsts"/>
                      </for>

                      <!-- FGDC: if a distributor is provided, then distribution liability must be provided -->
                      <for xpath="//distInfo/distributor[.//*]">
                        <exists xpath="//dataIdInfo/resConst/LegConsts/useLimit[. != '']" ref="useLimit,.,useLimitDist"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.SpatialRepresentation">
                    <validation>

                      <!-- dimension type -->
                      <for xpath="//axisDimension">
                        <exists xpath=".[@type != '']" ref="DimType"/>
                        <exists xpath="dimSize[. != '']" ref="dimSize"/>
                      </for>

                      <for xpath="//dimResol[value != '']">
                        <exists xpath="value[@uom != '']" ref="ValueUoMUnits"/>
                      </for>

                      <!-- point in pixel -->
                      <for xpath="//Georect[ptInPixel]">
                        <exists xpath="ptInPixel/PixOrientCd[@value != '']" ref="ptInPixel"/>
                      </for>

                      <!-- cell geometry -->
                      <for xpath="//cellGeo">
                        <exists xpath="CellGeoCd[@value != '']" ref="cellGeo"/>
                      </for>

                      <!-- feature count -->
                      <for xpath="//geometObjs">
                        <exists xpath="geoObjCnt[. != '']" ref="geoObjCnt"/>
                      </for>

                      <!-- geometric object type -->
                      <for xpath="//geoObjTyp[GeoObjTypCd]">
                        <exists xpath="GeoObjTypCd[@value != '']" ref="GeoObjTypCd"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//GridSpatRep">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//Georect">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- check point availablity -->
                      <for xpath="//Georect[chkPtAv = 'True']">
                        <exists xpath="chkPtDesc[. != '']" ref="chkPtDesc"/>
                      </for>

                      <!-- parameters -->
                      <for xpath="//Georef">
                        <exists xpath="georefPars[. != '']" ref="georefPars"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//Georef">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//spatRepInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//spatRepInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date/*[. != '']" ref="dates"/>
                      </for>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//spatRepInfo//paraCit//citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//spatRepInfo//paraCit//citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//spatRepInfo//paraCit//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ContentInformation">
                    <validation>

                      <!-- all content information citations -->
                      <!--  title and date required -->
                      <for xpath="//contInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <!-- FGDC: publication date is required -->
                        <exists xpath="date/pubDate[. != '']" ref="pubDate"/>
                      </for>
                      <!--  follow ISO title and date rules for identifiers -->
                      <for xpath="//idCitation//identAuth[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources -->
                      <for xpath="//contInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!--  code required for identifiers -->
                      <for xpath="//contInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                      <!--  feature catalogue -->
                      <!--  included With dataset is mandatory -->
                      <for xpath="//FetCatDesc[incWithDS]">
                        <exists xpath="incWithDS[. != '']" ref="incWithDS"/>
                      </for>

                      <!-- citation FGDC: contact name or org is required; position is optional -->
                      <for xpath="//catCitation//citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- citation FGDC: address not required for originators and publishers-->
                      <for xpath="//catCitation//citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- citation contact linkage -->
                      <for xpath="//catCitation//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!--  coverage and image description -->
                      <!-- attribute description -->
                      <for xpath="//CovDesc">
                        <exists xpath="attDesc[. != '']" ref="attDesc"/>
                      </for>
                      <for xpath="//ImgDesc">
                        <exists xpath="attDesc[. != '']" ref="attDesc"/>
                      </for>

                      <!-- content type code -->
                      <for xpath="//contentTyp">
                        <exists xpath="ContentTypCd[@value != '']" ref="ContentTypCd"/>
                      </for>

                      <!-- sequence identifier -->
                      <for xpath="//CovDesc//RangeDim">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//CovDesc//Band">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//ImgDesc//RangeDim">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//ImgDesc//Band">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>

                      <!-- band -->
                      <for xpath="//Band[minVal != '' or maxVal != '']">
                        <exists xpath="self::*[minVal &lt; maxVal]" ref="Band,.,bandMinMax minVal,minVal maxVal,maxVal"/>
                        <exists xpath="valUnit/UOM/unitSymbol[. != '']" ref="uom"/>
                      </for>

                      <!--  image description identifiers -->
                      <!-- citation FGDC: contact name or org is required; position is optional -->
                      <for xpath="//ImgDesc//citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- citation FGDC: address not required for originators and publishers-->
                      <for xpath="//ImgDesc//citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- citation contact linkage -->
                      <for xpath="//ImgDesc//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DataQuality">
                    <validation>

                      <!-- data quality report type -->
                      <for xpath="//dqInfo/report">
                        <exists xpath=".[@type != '']" ref="ReportType"/>
                      </for>

                      <!-- scope level is required -->
                      <!-- FGDC: not required
            <for xpath="//dqInfo">
              <exists xpath="dqScope/scpLvl/ScopeCd[@value != '']" ref="scopeCd"/>
            </for>
            -->

                      <!-- if scope does not equal "dataset" or "series", then a Level Description is required -->
                      <!-- FGDC: not required
            <for xpath="//dqInfo/dqScope[scpLvl/ScopeCd/@value != '005' and scpLvl/ScopeCd/@value != '006' and scpLvl/ScopeCd/@value != '']">
              <exists xpath="scpLvlDesc[.//* != '']" ref="scpLvlDesc"/>
            </for>
            -->

                      <!-- either lineage information or a data quality report must be provided for datasets -->
                      <!-- FGDC: not required
            <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005']">
              <or ref="datasetReq">                
                <exists xpath="dataLineage[.//* !='']"/>
                <exists xpath="report[.//*  !='']"/>
                <exists xpath="report[descendant-or-self::*/@code !='' or descendant-or-self::*/@value !='' or descendant-or-self::*/@type !='']"/>           
              </or>
            </for> -->

                      <!-- FGDC: conceptual consistency report is required if data quality reports or lineage information is provided -->
                      <!-- <for xpath="//dqInfo[(report/@type != 'DQConcConsis' and report/@type != 'DQCompOm') or dataLineage//* != '']"> -->
                      <for xpath="//dqInfo[( report and ( not(report/@type) or (report/@type = '') ) ) or ( ( (report//* != '') or (dataLineage//* != '') ) and ( not(report/@type) or (report/@type = '') or (report/@type = 'DQQuanAttAcc') or (report/@type = 'DQAbsExtPosAcc') ) ) or ( ( (report/@type = 'DQCompOm') or (report/@type = 'DQConcConsis') ) and not( (report/@type = 'DQCompOm') and (report/@type = 'DQConcConsis') ) )]">
                        <exists xpath="report[@type = 'DQConcConsis']" ref="DQConcConsis"/>
                        <exists xpath="report[@type = 'DQCompOm']" ref="DQCompOm"/>
                      </for>

                      <!-- FGDC: within these reports, measure description and eval method description are required -->
                      <for xpath="//dqInfo/report[@type != 'DQConcConsis' and @type != 'DQCompOm']">
                        <exists xpath="measDesc[. != '']" ref="measDesc"/>
                        <exists xpath="evalMethDesc[. != '']" ref="evalMethDesc"/>
                      </for>

                      <!-- FGDC: within these reports, only measure description is required -->
                      <for xpath="//dqInfo/report[@type = 'DQConcConsis' or @type = 'DQCompOm']">
                        <exists xpath="measDesc[. != '']" ref="measDesc"/>
                      </for>

                      <!-- within the report section, either a conformance result or a quantitative result must be provided -->
                      <!-- FGDC: for conceptual consistency or completeness omission, only a measure description is required -->
                      <for xpath="//dqInfo/report[(@type != 'DQConcConsis') and (@type != 'DQCompOm')]">
                        <or ref="reportReq">
                          <exists xpath="measResult/ConResult//*[ . != '']"/>
                          <exists xpath="measResult/QuanResult//*[ . != '']"/>
                        </or>
                      </for>


                      <!-- within the conformance result section, all of its elements are mandatory -->
                      <for xpath="//dqInfo/report/measResult/ConResult">
                        <exists xpath="conExpl[ . != '']" ref="conExpl"/>
                        <exists xpath="conSpec[ descendant::* != '']" ref="conSpec"/>
                        <exists xpath="conPass[ . != '']" ref="conPass"/>
                      </for>

                      <!-- within the Quantitative Result section, a value and a unit of measure are required. -->
                      <for xpath="//dqInfo/report/measResult/QuanResult">
                        <exists xpath="quanValUnit/UOM/unitSymbol[ .!= '']" ref="uom"/>
                      </for>
                      <for xpath="//dqInfo/report/measResult/QuanResult/quanVal">
                        <exists xpath="self::*[ . != '']" ref="quanVal"/>
                      </for>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//report//citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//report//citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//report//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//dqInfo/report//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dqInfo/report//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- identifier -->
                      <for xpath="//dqInfo/report//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                      <!-- bounding box -->
                      <for xpath="//scpExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//scpExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//scpExt//citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//scpExt//citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//scpExt//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.LI_Lineage">
                    <validation>

                      <!-- if scope = "dataset" or "series", one of process step, data source, or lineage statement is required -->
                      <!-- FGDC: not required
            <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']">
              <exists xpath=".//*[ . != '']" ref="dqInfo"/>
            </for>
            -->

                      <!-- FGDC: this required if there are reports, not tied to scope codes -->
                      <for xpath="//dqInfo[report//* != '']">
                        <!-- <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']"> -->
                        <for xpath="dataLineage">
                          <or ref="dataLineage_FGDC">
                            <!-- FGDC not required
                  <exists xpath="statement[. != '']"/>
                  <exists xpath="dataSource/*[. != '']"/>
                  -->
                            <exists xpath="prcStep/*[. != '']"/>
                          </or>
                        </for>
                      </for>

                      <!-- either lineage information or a data quality report must be provided for datasets -->
                      <!-- FGDC: not required
            <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005']">
              <or ref="datasetReq">                
                <exists xpath="dataLineage[.//* !='']"/>
                <exists xpath="report[.//*  !='']"/>
                <exists xpath="report[descendant-or-self::*/@code !='' or descendant-or-self::*/@value !='' or descendant-or-self::*/@type !='']"/>           
              </or>
            </for>
            -->

                      <!-- process step description -->
                      <for xpath="//prcStep">
                        <exists xpath="stepDesc[. != '']" ref="stepDesc"/>
                        <!-- FGDC: date is required -->
                        <exists xpath="stepDateTm[. != '']" ref="stepDateTm"/>
                      </for>

                      <!-- Within data source, either an extent or a description must be provided -->
                      <for xpath="//dqInfo/dataLineage/dataSource">
                        <or ref="dataSource">
                          <exists xpath="srcDesc[. != '']"/>
                          <exists xpath="srcExt/*[. != '']"/>
                        </or>
                      </for>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//prcStep/stepProc">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//prcStep/stepProc[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//prcStep/stepProc/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//dataLineage//citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//dataLineage//citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataLineage//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- bounding box -->
                      <for xpath="//srcExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//srcExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>

                      <!-- FGDC: a temporal extent period or instant is required -->
                      <for xpath="/metadata">
                        <exists xpath="//dataLineage/dataSource[not(srcExt) or (srcExt/tempEle//* != '')]" ref="temporalReq"/>
                        <exists xpath="//dataLineage//stepSrc[not(srcExt) or (srcExt/tempEle//* != '')]" ref="temporalReq"/>
                      </for>

                      <!-- FGDC: a description is required if a temporal extent is used -->
                      <for xpath="//srcExt[tempEle]">
                        <exists xpath="exDesc[. != '']" ref="exDesc,.,tempEle_exDesc"/>
                      </for>

                      <!-- data source referense system -->
                      <for xpath="//dataLineage//srcRefSys[identCode]">
                        <exists xpath="identCode[@code != '']" ref="identCode"/>
                      </for>

                      <!-- citations -->
                      <for xpath="//dataLineage//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <!-- FGDC: publication date is required -->
                        <exists xpath="date/pubDate[. != '']" ref="pubDate"/>
                      </for>
                      <for xpath="//dataLineage//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- identifiers -->
                      <for xpath="//dataLineage//*[identCode and not(identCode/@code)]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DistributionInfo">
                    <validation>

                      <!-- format name and version -->
                      <for xpath="//distorFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                      </for>

                      <!-- if a density value is provided, the density units is mandatory -->
                      <for xpath="//offLineMed[medDensity != '']">
                        <exists xpath="medDenUnits[. != '']" ref="medDenUnits"/>
                      </for>

                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//distributor/distorCont">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//distributor/distorCont[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//distributor/distorCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//distInfo//onLineSrc">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.EntityAttributeInfo">
                    <validation>

                      <!-- codeset domains -->
                      <for xpath="//codesetd">
                        <exists xpath="codesetn[. != '']" ref="codesetn"/>
                        <exists xpath="codesets[. != '']" ref="codesets"/>
                      </for>

                      <!-- enumerated domains -->
                      <for xpath="//edom">
                        <exists xpath="edomv[. != '']" ref="edomv"/>
                        <exists xpath="edomvd[. != '']" ref="edomvd"/>
                        <exists xpath="edomvds[. != '']" ref="edomvds"/>
                      </for>

                      <!-- range domains -->
                      <for xpath="//rdom">
                        <exists xpath="rdommin[. != '']" ref="rdommin"/>
                        <exists xpath="rdommax[. != '']" ref="rdommax"/>
                        <exists xpath=".[rdommin &lt; rdommax]" ref="rdommin,rdommin,rdommin_range"/>
                      </for>

                      <!-- entity type -->
                      <for xpath="//enttyp">
                        <exists xpath="enttypd[. != '']" ref="enttypd"/>
                        <exists xpath="enttypds[. != '']" ref="enttypds"/>
                        <!-- entity type label -->
                        <exists xpath="enttypl[. != '']" ref="enttypl"/>
                      </for>

                      <!-- attribute label -->
                      <for xpath="//attr">
                        <exists xpath="attrlabl[. != '']" ref="attrlabl"/>

                        <!-- attribute definition -->
                        <exists xpath="attrdef[. != '']" ref="attrdef"/>

                        <!-- attribute source -->
                        <exists xpath="attrdefs[. != '']" ref="attrdefs"/>

                        <!-- TODO: not working / attribute type -->
                        <exists xpath="attrtype[. != '']" ref="attrtype"/>

                        <!-- TODO: not working / attribute width -->
                        <exists xpath="attwidth[. != '']" ref="attwidth"/>
                      </for>

                      <for xpath="/metadata/eainfo/detailed/attr">
                        <exists xpath="attrdomv[count(edom | rdom | codesetd | udom) = 1]" ref="attrdomv"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.References">
                    <validation>

                      <!-- aggregate resource -->
                      <!-- association type required under aggregate information -->
                      <for xpath="//aggrInfo/assocType">
                        <exists xpath="AscTypeCd[@value != '']" ref="AscTypeCd"/>
                      </for>
                      <!-- either a citation or an identifier for the aggregate resource must be provided -->
                      <for xpath="//aggrInfo">
                        <or ref="aggrInfo">
                          <exists xpath="aggrDSIdent/identCode[.!='']"/>
                          <exists xpath="aggrDSName//*[.!='']"/>
                        </or>
                      </for>
                      <!-- title and date required for aggregate citation, cross-reference or larger work citation -->
                      <for xpath="//aggrInfo//aggrDSName[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <!-- rule present only because FGDC rule below won't appear on page (tried adding it in any location on page with same result) -->
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                        <!-- FGDC: publication date is required -->
                        <exists xpath="date/pubDate[. != '']" ref="pubDate"/>
                      </for>
                      <!-- citation identifier authority citation title and date required - ISO rules since FGDC doesn't have identifiers -->
                      <for xpath="//aggrInfo//identAuth[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//aggrInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//aggrInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//aggrInfo//citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//aggrInfo//citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//aggrInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- portrayal catalogue  -->
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//porCatInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//porCatInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//porCatInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//porCatInfo//citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//porCatInfo//citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//porCatInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- application schema -->
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//appSchInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//appSchInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//appSchInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- FGDC: contact name or org is required; position is optional -->
                      <for xpath="//appSchInfo//citRespParty">
                        <exists xpath="self::*[rpIndName != '' or rpOrgName != '']" ref="partyFgdc IndName,rpIndName OrgName,rpOrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- FGDC: address not required for originators and publishers-->
                      <for xpath="//appSchInfo//citRespParty[role/RoleCd/@value != '006' and role/RoleCd/@value != '010']">
                        <exists xpath="rpCntInfo/cntAddress[@addressType != '']" ref="addressType,@addressType"/>
                        <exists xpath="rpCntInfo/cntAddress/adminArea[. != '']" ref="adminArea,.,adminArea_FGDC"/>
                        <exists xpath="rpCntInfo/cntAddress/postCode[. != '']" ref="postCode"/>
                        <exists xpath="rpCntInfo/cntAddress/city[. != '']" ref="city"/>
                        <exists xpath="rpCntInfo/cntPhone/voiceNum[(not(@tddtty) or @tddtty = '' or @tddtty = 'voice' or @tddtty = 'False' or @tddtty = 'false') and . != '']" ref="voiceNum"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//appSchInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.GeoprocessingHistory"></page>
                </section>
              </forms>
            </editor>
          </metadataConfig>
        </content>
      </insertComponent>
      <insertComponent id="esri_metadata_metadataEditor_inspire" className="InspireMetadataEditor">
        <content type="INSPIRE" displayName="INSPIRE Metadata Directive">
          <metadataConfig ArcGISProfile="INSPIRE" ValidatePages="True">
            <validationNamespaceURI>http://www.isotc211.org/2005/gmd</validationNamespaceURI>
            <validationSchemaURL>http://www.isotc211.org/schemas/2005/gmd/metadataEntity.xsd</validationSchemaURL>
            <tranformStyle>ISO19139</tranformStyle>
            <viewerXslt>Metadata\Stylesheets\ArcGISProFull.xsl</viewerXslt>
            <editor>
              <forms>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Overview">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ItemInfo">
                    <validation>

                      <!-- title -->
                      <exists xpath="/metadata/dataIdInfo/idCitation/resTitle[. != '']" ref="resTitle"/>

                      <!-- abstract -->
                      <for xpath="/metadata[not(tool)]">
                        <exists xpath="dataIdInfo/idAbs[. != '']" ref="idAbs"/>
                      </for>

                      <!-- tool summary -->
                      <for xpath="/metadata[tool]">
                        <exists xpath="tool/summary[. != '']" ref="toolSummary"/>
                      </for>

                      <!-- tools -->
                      <for xpath="//scriptExample">
                        <exists xpath="title[. != '']" ref="scriptTitle"/>
                      </for>

                      <!-- extent -->
                      <for xpath="//dataExt//GeoBndBox[@esriExtentType = 'search' AND * != '']">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- INSPIRE: one type of use limitation is required -->
                      <for xpath="/metadata/dataIdInfo[not(resConst//useLimit)]">
                        <exists xpath="resConst//useLimit[. != '']" ref="useLimit"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Keywords">
                    <validation>

                      <!-- topic categories required for dataset or series -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '005' or mdHrLv/ScopeCd/@value = '006']">
                        <exists xpath="//dataIdInfo/tpCatBag[*/@value='True']" ref="topics"/>
                      </for>

                      <!-- theme keywords -->
                      <for xpath="/metadata/dataIdInfo/themeKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,themeKeywords"/>
                      </for>
                      <!-- place keywords -->
                      <for xpath="/metadata/dataIdInfo/placeKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,placeKeywords"/>
                      </for>
                      <!-- temporal keywords -->
                      <for xpath="/metadata/dataIdInfo/tempKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,temporalKeywords"/>
                      </for>
                      <!-- discipline keywords -->
                      <for xpath="/metadata/dataIdInfo/discKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,disciplineKeywords"/>
                      </for>
                      <!-- stratum keywords -->
                      <for xpath="/metadata/dataIdInfo/stratKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,stratumKeywords"/>
                      </for>
                      <!-- other keywords -->
                      <for xpath="/metadata/dataIdInfo/otherKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,otherKeywords"/>
                      </for>
                      <!-- product keywords -->
                      <for xpath="/metadata/dataIdInfo/productKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,productKeywords"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//thesaName/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//thesaName/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//thesaName//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//thesaName[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//thesaName//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <for xpath="//thesaName//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DatasetCitation">
                    <validation>

                      <!-- citation -->

                      <!-- title and date required for main citation and identifier citation -->
                      <for xpath="//idCitation[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//idCitation//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation identifier -->
                      <!-- INSPIRE: identifier code is required for dataset and series -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '005' or mdHrLv/ScopeCd/@value = '006']">
                        <exists xpath="//idCitation/citId/identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation identifier authority citation -->
                      <for xpath="//idCitation/citId/identAuth[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!-- identifier citation contacts -->
                      <!-- contact name, org or role -->
                      <for xpath="//idCitation/citId/identAuth/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//idCitation/citId/identAuth/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceCitationContacts">
                    <validation>

                      <!-- contact name, org or role -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ContactManager"></page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Locales">
                    <validation>
                      <!-- language is required for all locales -->
                      <for xpath="/metadata/Esri/locales/locale">
                        <exists xpath=".[@language != '']" ref="language"/>
                      </for>
                    </validation>
                  </page>
                </section>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Metadata">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataDetails">
                    <validation>

                      <!-- language is required for all iso styles -->
                      <exists xpath="/metadata/mdLang/languageCode[@value != '']" ref="languageCode"/>

                      <!-- if the level code is not 'dataset', then level name is required -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value != '005' and mdHrLv/ScopeCd/@value != '']">
                        <exists xpath="/metadata/mdHrLvName[. != '']" ref="mdHrLvName"/>
                      </for>

                      <!-- INSPIRE: hierarchy level is required -->
                      <exists xpath="/metadata/mdHrLv/ScopeCd[@value != '']" ref="scopeCd"/>

                      <!-- date stamp is required -->
                      <exists xpath="/metadata/mdDateSt[. != '']" ref="mdDateSt"/>

                      <!-- INSPIRE: languages must be from the set of 23 official EU languages -->
                      <for xpath="/metadata/mdLang/languageCode[@value !='']">
                        <exists xpath=".[@value='bul' or @value='cze' or @value='dan' or @value='eng' or @value='dut' or @value='est' or @value='fin' or @value='fre' or @value='ger' or @value='gre' or @value='hun' or @value='gle' or @value='ita' or @value='lav' or @value='lit' or @value='mlt' or @value='pol' or @value='por'  or @value='rum' or @value='slo' or @value='slv' or @value='spa' or @value='swe']" ref="languageCode,.,languageCode_EU"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataContacts">
                    <validation>

                      <!-- one contact requried -->
                      <exists xpath="/metadata[mdContact]" ref="mdContact"/>

                      <!-- contact name, org or role -->
                      <for xpath="//mdContact">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- INSPIRE: organization -->
                      <for xpath="//mdContact">
                        <exists xpath="rpOrgName[. != '']" ref="OrgName"/>
                      </for>

                      <!-- INSPIRE: email -->
                      <for xpath="//mdContact">
                        <exists xpath="rpCntInfo/cntAddress/eMailAdd[. != '']" ref="eMailAdd"/>
                      </for>

                      <!-- INSPIRE: contacts role must be 'point of contact' -->
                      <for xpath="//mdContact">
                        <exists xpath="role[RoleCd/@value = '007']" ref="role,.,role_POC"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//mdContact/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataMaintenance">
                    <validation>

                      <for xpath="//mdMaint">

                        <!-- maintentance frequency -->
                        <for xpath="maintFreq">
                          <exists xpath="MaintFreqCd[@value != '']" ref="maintFreq"/>
                        </for>

                        <!-- maintenance scope -->
                        <for xpath="maintScp">
                          <exists xpath="ScopeCd[@value != '']" ref="scopeCd"/>
                        </for>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//mdMaint/maintCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//mdMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>

                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataConstraints">
                    <validation>
                      <!-- classification code -->
                      <for xpath="//mdConst/SecConsts">
                        <exists xpath="class/ClasscationCd[@value != '']" ref="ClasscationCd"/>
                      </for>
                      <!-- if the 'other contraints' code is used, then the other contraints tag is required -->
                      <for xpath="//mdConst/LegConsts[*/RestrictCd/@value = '008']">
                        <exists xpath="othConsts[. != '']" ref="othConsts"/>
                      </for>
                      <!-- use constraint is required in the general class -->
                      <for xpath="//mdConst/Consts">
                        <exists xpath="useLimit[. != '']" ref="useLimit"/>
                      </for>
                    </validation>
                  </page>
                </section>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Resource">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceDetails">
                    <validation>

                      <!-- language of the dataset is mandatory as long as the hierarchy level code != service -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value != '014']">
                        <exists xpath="//dataIdInfo/dataLang/languageCode[@value != '']" ref="languageCode"/>
                      </for>

                      <!-- scale -->
                      <for xpath="//dataIdInfo//scaleDist[value != '']">
                        <exists xpath="value[@uom != '']" ref="uom,@uom"/>
                      </for>

                      <!-- format name and version -->
                      <for xpath="//dsFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>

                      <!-- browse file name -->
                      <for xpath="//graphOver">
                        <exists xpath="bgFileName[. != '']" ref="bgFileName"/>
                      </for>

                      <!-- spec usage -->
                      <for xpath="//idSpecUse">
                        <exists xpath="specUsage[. != '']" ref="specUsage"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//idSpecUse/usrCntInfo">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//idSpecUse/usrCntInfo/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Services">
                    <validation>

                      <!-- service validation -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '014']/dataIdInfo">
                        <exists xpath="svType/genericName[. != '']" ref="genericName"/>
                        <exists xpath="svCouplType[CouplTypCd/@value != '']" ref="svCouplType"/>
                      </for>
                      <for xpath="//svCouplType[CouplTypCd/@value = '003']">
                        <exists xpath="//svCouplRes[svOpName != '' and svResCitId/identCode != '']" ref="svCouplRes svOpName,svOpName svResCitId,svResCitId/identCode"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceExtent">
                    <validation>

                      <!-- either a bounding box or a geographic description (identifier) must be provided if the item's hierarchy level is "dataset" -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '005']">
                        <or ref="dataExtReq">
                          <exists xpath="//dataExt//GeoBndBox[*]"/>
                          <exists xpath="//dataExt//GeoDesc/geoId/identCode[ . != '']"/>
                        </or>
                      </for>

                      <for xpath="//dataExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- INSPIRE: at least one geographic bounding box must always be provided, except for service-specific rules -->
                      <exists xpath="//dataExt//GeoBndBox[*]" ref="dataExtGeoBndBoxReq"/>

                      <!-- vertical max and min -->
                      <for xpath="//dataExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>
                      <for xpath="//dataExt//vertEle[* != '']">
                        <exists xpath="self::*[vertMinVal &lt; vertMaxVal]" ref="vertMinMaxVal vertMinVal,vertMinVal vertMaxVal,vertMaxVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//dataExt//GeoDesc//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataExt//GeoDesc//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//dataExt//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//dataExt//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dataExt//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourcePoc">
                    <validation>

                      <!-- contact name, org or role -->
                      <for xpath="//dataIdInfo/idPoC">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataIdInfo/idPoC/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- INSPIRE: contact organization, role and email are required-->
                      <for xpath="//dataIdInfo/idPoC">
                        <exists xpath="rpOrgName[. != '']" ref="OrgName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                        <exists xpath=".//eMailAdd[. != '']" ref="eMailAdd"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceMaintenance">
                    <validation>

                      <for xpath="//resMaint">

                        <!-- maintentance frequency -->
                        <for xpath="maintFreq">
                          <exists xpath="MaintFreqCd[@value != '']" ref="maintFreq"/>
                        </for>

                        <!-- maintenance scope -->
                        <for xpath="maintScp">
                          <exists xpath="ScopeCd[@value != '']" ref="scopeCd"/>
                        </for>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//resMaint/maintCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//resMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceConstraints">
                    <validation>
                      <!-- classification code -->
                      <for xpath="//resConst/SecConsts">
                        <exists xpath="class/ClasscationCd[@value != '']" ref="ClasscationCd"/>
                      </for>
                      <!-- if the 'other contraints' code is used, then the other contraints tag is required -->
                      <for xpath="//resConst/LegConsts[*/RestrictCd/@value = '008']">
                        <exists xpath="othConsts[. != '']" ref="othConsts"/>
                      </for>
                      <!-- INSPIRE: at lease one is required -->
                      <for xpath="//dataIdInfo">
                        <or ref="resConst">
                          <exists xpath="resConst/LegConsts[accessConsts/RestrictCd/@value != '']"/>
                          <exists xpath="resConst/SecConsts[class/ClasscationCd/@value != '']"/>
                        </or>
                      </for>
                      <!-- INSPIRE: one type of use limitation is required -->
                      <for xpath="//dataIdInfo[not(resConst//useLimit)]">
                        <exists xpath="resConst//useLimit[. != '']" ref="useLimit"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ReferenceSystem">
                    <validation>
                      <!-- reference system ID -->
                      <for xpath="//RefSystem">
                        <exists xpath="refSysID/identCode[@code != '']" ref="refSysID"/>
                      </for>

                      <!-- identifier authority citation -->
                      <for xpath="//refSysInfo//identAuth[*]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!-- identifier authority citation linkage -->
                      <for xpath="//refSysInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- identifier authority citation identifier -->
                      <for xpath="//refSysInfo//identAuth/citId">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- identifier authority citation contacts -->
                      <!-- contact name, org or role -->
                      <for xpath="//refSysInfo//identAuth//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//refSysInfo//identAuth//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.SpatialRepresentation">
                    <validation>

                      <!-- dimension type -->
                      <for xpath="//axisDimension">
                        <exists xpath=".[@type != '']" ref="DimType"/>
                        <exists xpath="dimSize[. != '']" ref="dimSize"/>
                      </for>

                      <for xpath="//dimResol[value != '']">
                        <exists xpath="value[@uom != '']" ref="ValueUoMUnits"/>
                      </for>

                      <!-- point in pixel -->
                      <for xpath="//Georect[ptInPixel]">
                        <exists xpath="ptInPixel/PixOrientCd[@value != '']" ref="ptInPixel"/>
                      </for>

                      <!-- cell geometry -->
                      <for xpath="//cellGeo">
                        <exists xpath="CellGeoCd[@value != '']" ref="cellGeo"/>
                      </for>

                      <!-- feature count -->
                      <for xpath="//geometObjs">
                        <exists xpath="geoObjCnt[. != '']" ref="geoObjCnt"/>
                      </for>

                      <!-- geometric object type -->
                      <for xpath="//geoObjTyp[GeoObjTypCd]">
                        <exists xpath="GeoObjTypCd[@value != '']" ref="GeoObjTypCd"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//GridSpatRep">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//Georect">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- check point availablity -->
                      <for xpath="//Georect[chkPtAv = 'True']">
                        <exists xpath="chkPtDesc[. != '']" ref="chkPtDesc"/>
                      </for>

                      <!-- parameters -->
                      <for xpath="//Georef">
                        <exists xpath="georefPars[. != '']" ref="georefPars"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//Georef">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//spatRepInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//spatRepInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date/*[. != '']" ref="dates"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//spatRepInfo//paraCit//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//spatRepInfo//paraCit//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ContentInformation">
                    <validation>

                      <!-- all content information citations -->
                      <!--  title and date required -->
                      <for xpath="//contInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources -->
                      <for xpath="//contInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!--  code required for identifiers -->
                      <for xpath="//contInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                      <!--  feature catalogue -->
                      <!--  included With dataset is mandatory -->
                      <for xpath="//FetCatDesc[incWithDS]">
                        <exists xpath="incWithDS[. != '']" ref="incWithDS"/>
                      </for>

                      <!-- citation contact name, org or role -->
                      <for xpath="//catCitation//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- citation contact linkage -->
                      <for xpath="//catCitation//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!--  coverage and image description -->
                      <!-- attribute description -->
                      <for xpath="//CovDesc">
                        <exists xpath="attDesc[. != '']" ref="attDesc"/>
                      </for>
                      <for xpath="//ImgDesc">
                        <exists xpath="attDesc[. != '']" ref="attDesc"/>
                      </for>

                      <!-- content type code -->
                      <for xpath="//contentTyp">
                        <exists xpath="ContentTypCd[@value != '']" ref="ContentTypCd"/>
                      </for>

                      <!-- sequence identifier -->
                      <for xpath="//CovDesc//RangeDim">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//CovDesc//Band">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//ImgDesc//RangeDim">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//ImgDesc//Band">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>

                      <!-- band -->
                      <for xpath="//Band[minVal != '' or maxVal != '']">
                        <exists xpath="self::*[minVal &lt; maxVal]" ref="Band,.,bandMinMax minVal,minVal maxVal,maxVal"/>
                        <exists xpath="valUnit/UOM/unitSymbol[. != '']" ref="uom"/>
                      </for>

                      <!--  image description identifiers -->
                      <!-- citation contact name, org or role -->
                      <for xpath="//ImgDesc//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- citation contact linkage -->
                      <for xpath="//ImgDesc//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DataQuality">
                    <validation>

                      <!-- INSPIRE: There must be exactly one data quality section "scoped to the full resource", i.e. either the "dataset" or "series" -->
                      <exists xpath="//dqInfo/dqScope[scpLvl/ScopeCd/@value = '005' or scpLvl/ScopeCd/@value = '006']" ref="dqScope"/>

                      <!-- data quality report type -->
                      <for xpath="//dqInfo/report">
                        <exists xpath=".[@type != '']" ref="ReportType"/>
                      </for>

                      <!-- scope level is required -->
                      <for xpath="//dqInfo">
                        <exists xpath="dqScope/scpLvl/ScopeCd[@value != '']" ref="scopeCd"/>
                      </for>

                      <!-- if scope does not equal "dataset" or "series", then a Level Description is required -->
                      <for xpath="//dqInfo/dqScope[scpLvl/ScopeCd/@value != '005' and scpLvl/ScopeCd/@value != '006' and scpLvl/ScopeCd/@value != '']">
                        <exists xpath="scpLvlDesc[.//* != '']" ref="scpLvlDesc"/>
                      </for>

                      <!-- either lineage information or a data quality report must be provided for datasets -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005']">
                        <or ref="datasetReq">
                          <exists xpath="dataLineage[.//* !='']"/>
                          <exists xpath="report[.//*  !='']"/>
                          <exists xpath="report[descendant-or-self::*/@code !='' or descendant-or-self::*/@value !='' or descendant-or-self::*/@type !='']"/>
                        </or>
                      </for>

                      <!-- within the report section, either a conformance result or a quantitative result must be provided -->
                      <for xpath="//dqInfo/report">
                        <or ref="reportReq">
                          <exists xpath="measResult/ConResult//*[ . != '']"/>
                          <exists xpath="measResult/QuanResult//*[ . != '']"/>
                        </or>
                      </for>

                      <!-- within the conformance result section, all of its elements are mandatory -->
                      <for xpath="//dqInfo/report/measResult/ConResult">
                        <!-- INSPIRE: not required
              <exists xpath="conExpl[ . != '']" ref="conExpl"/>
              -->
                        <exists xpath="conSpec[ descendant::* != '']" ref="conSpec"/>
                        <exists xpath="conPass[ . != '']" ref="conPass"/>
                      </for>

                      <!-- within the Quantitative Result section, a value and a unit of measure are required. -->
                      <for xpath="//dqInfo/report/measResult/QuanResult">
                        <exists xpath="quanValUnit/UOM/unitSymbol[ .!= '']" ref="uom"/>
                      </for>
                      <for xpath="//dqInfo/report/measResult/QuanResult/quanVal">
                        <exists xpath="self::*[ . != '']" ref="quanVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//report//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//report//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//dqInfo/report//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dqInfo/report//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- identifier -->
                      <for xpath="//dqInfo/report//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                      <!-- bounding box -->
                      <for xpath="//scpExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//scpExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//scpExt//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//scpExt//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- INSPIRE: at least one domain consistency quality report must be provided -->
                      <exists xpath="//dqInfo/report[@type = 'DQDomConsis']//*[. != '']" ref="ReportType,.,DQDomConsis"/>
                      <exists xpath="//dqInfo/report[@type = 'DQDomConsis']/measResult/ConResult//*[ . != '']" ref="ReportType,.,DQDomConsis_Report"/>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.LI_Lineage">
                    <validation>

                      <!-- if scope = "dataset" or "series", one of process step, data source, or lineage statement is required -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']">
                        <exists xpath=".//*[ . != '']" ref="dqInfo"/>
                      </for>
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']">
                        <for xpath="dataLineage">
                          <or ref="dataLineage">
                            <exists xpath="statement[. != '']"/>
                            <exists xpath="dataSource/*[. != '']"/>
                            <exists xpath="prcStep/*[. != '']"/>
                          </or>
                        </for>
                      </for>

                      <!-- either lineage information or a data quality report must be provided for datasets -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005']">
                        <or ref="datasetReq">
                          <exists xpath="dataLineage[.//* !='']"/>
                          <exists xpath="report[.//*  !='']"/>
                          <exists xpath="report[descendant-or-self::*/@code !='' or descendant-or-self::*/@value !='' or descendant-or-self::*/@type !='']"/>
                        </or>
                      </for>

                      <!-- process step description -->
                      <for xpath="//prcStep">
                        <exists xpath="stepDesc[. != '']" ref="stepDesc"/>
                      </for>

                      <!-- INSPIRE: A lineage statement is mandatory in the data quality section that addresses the full resource for datasets and series -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']">
                        <exists xpath="dataLineage/statement[. != '']" ref="dqStatement"/>
                      </for>

                      <!-- Within data source, either an extent or a description must be provided -->
                      <for xpath="//dqInfo/dataLineage/dataSource">
                        <or ref="dataSource">
                          <exists xpath="srcDesc[. != '']"/>
                          <exists xpath="srcExt/*[. != '']"/>
                        </or>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//prcStep/stepProc">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//prcStep/stepProc/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//dataLineage//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataLineage//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- bounding box -->
                      <for xpath="//srcExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//srcExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>

                      <!-- data source referense system -->
                      <for xpath="//dataLineage//srcRefSys[identCode]">
                        <exists xpath="identCode[@code != '']" ref="identCode"/>
                      </for>

                      <!-- citations -->
                      <for xpath="//dataLineage//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dataLineage//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- identifiers -->
                      <for xpath="//dataLineage//*[identCode and not(identCode/@code)]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DistributionInfo">
                    <validation>

                      <!-- format name and version -->
                      <for xpath="//distFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>
                      <for xpath="//distorFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>

                      <!-- if a density value is provided, the density units is mandatory -->
                      <for xpath="//offLineMed[medDensity != '']">
                        <exists xpath="medDenUnits[. != '']" ref="medDenUnits"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//distributor/distorCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//distributor/distorCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//distorTran/onLineSrc">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- INSPIRE: requires one digital transfer linkage -->
                      <for xpath="/metadata">
                        <exists xpath="distInfo/distTranOps/onLineSrc/linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.EntityAttributeInfo">
                    <validation>

                      <!-- codeset domains -->
                      <for xpath="//codesetd">
                        <exists xpath="codesetn[. != '']" ref="codesetn"/>
                        <exists xpath="codesets[. != '']" ref="codesets"/>
                      </for>

                      <!-- enumerated domains -->
                      <for xpath="//edom">
                        <exists xpath="edomv[. != '']" ref="edomv"/>
                        <exists xpath="edomvd[. != '']" ref="edomvd"/>
                        <exists xpath="edomvds[. != '']" ref="edomvds"/>
                      </for>

                      <!-- range domains -->
                      <for xpath="//rdom">
                        <exists xpath="rdommin[. != '']" ref="rdommin"/>
                        <exists xpath="rdommax[. != '']" ref="rdommax"/>
                        <exists xpath=".[rdommin &lt; rdommax]" ref="rdommin,rdommin,rdommin_range"/>
                      </for>

                      <!-- entity type -->
                      <for xpath="//enttyp">
                        <exists xpath="enttypd[. != '']" ref="enttypd"/>
                        <exists xpath="enttypds[. != '']" ref="enttypds"/>
                        <!-- entity type label -->
                        <exists xpath="enttypl[. != '']" ref="enttypl"/>
                      </for>

                      <!-- attribute label -->
                      <for xpath="//attr">
                        <exists xpath="attrlabl[. != '']" ref="attrlabl"/>

                        <!-- attribute definition -->
                        <exists xpath="attrdef[. != '']" ref="attrdef"/>

                        <!-- attribute source -->
                        <exists xpath="attrdefs[. != '']" ref="attrdefs"/>

                        <!-- TODO: not working / attribute type -->
                        <exists xpath="attrtype[. != '']" ref="attrtype"/>

                        <!-- TODO: not working / attribute width -->
                        <exists xpath="attwidth[. != '']" ref="attwidth"/>
                      </for>

                      <for xpath="/metadata/eainfo/detailed/attr">
                        <exists xpath="attrdomv[count(edom | rdom | codesetd | udom) = 1]" ref="attrdomv"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.References">
                    <validation>

                      <!-- aggregate resource -->
                      <!-- association type required under aggregate information -->
                      <for xpath="//aggrInfo/assocType">
                        <exists xpath="AscTypeCd[@value != '']" ref="AscTypeCd"/>
                      </for>
                      <!-- either a citation or an identifier for the aggregate resource must be provided -->
                      <for xpath="//aggrInfo">
                        <or ref="aggrInfo">
                          <exists xpath="aggrDSIdent/identCode[.!='']"/>
                          <exists xpath="aggrDSName//*[.!='']"/>
                        </or>
                      </for>
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//aggrInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//aggrInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//aggrInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//aggrInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//aggrInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- portrayal catalogue  -->
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//porCatInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//porCatInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//porCatInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//porCatInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//porCatInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- application schema -->
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//appSchInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//appSchInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//appSchInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//appSchInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//appSchInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.GeoprocessingHistory"></page>
                </section>
              </forms>
            </editor>
          </metadataConfig>
        </content>
      </insertComponent>
      <insertComponent id="esri_metadata_metadataEditor_iso19139Gml32" className="ISO19139Gml32MetadataEditor">
        <content type="ISO19139GML32" displayName="ISO 19139 Metadata Implementation Specification GML3.2">
          <metadataConfig ArcGISProfile="ISO19139" ValidatePages="True">
            <validationNamespaceURI>http://www.isotc211.org/2005/gmd</validationNamespaceURI>
            <validationSchemaURL>http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/gmd/metadataEntity.xsd</validationSchemaURL>
            <tranformXslt>ArcGIS_2ISO19139gml321.xslt</tranformXslt>
            <viewerXslt>Metadata\Stylesheets\ArcGISProFull.xsl</viewerXslt>
            <editor>
              <forms>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Overview">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ItemInfo">
                    <validation>

                      <!-- title -->
                      <exists xpath="/metadata/dataIdInfo/idCitation/resTitle[. != '']" ref="resTitle"/>

                      <!-- abstract -->
                      <for xpath="/metadata[not(tool)]">
                        <exists xpath="dataIdInfo/idAbs[. != '']" ref="idAbs"/>
                      </for>

                      <!-- tool summary -->
                      <for xpath="/metadata[tool]">
                        <exists xpath="tool/summary[. != '']" ref="toolSummary"/>
                      </for>

                      <!-- tools -->
                      <for xpath="//scriptExample">
                        <exists xpath="title[. != '']" ref="scriptTitle"/>
                      </for>

                      <!-- extent -->
                      <for xpath="//dataExt//GeoBndBox[@esriExtentType = 'search' AND * != '']">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Keywords">
                    <validation>

                      <!-- topic categories required for dataset or series -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '005' or mdHrLv/ScopeCd/@value = '006']">
                        <exists xpath="//dataIdInfo/tpCatBag[*/@value='True']" ref="topics"/>
                      </for>

                      <!-- theme keywords -->
                      <for xpath="/metadata/dataIdInfo/themeKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,themeKeywords"/>
                      </for>
                      <!-- place keywords -->
                      <for xpath="/metadata/dataIdInfo/placeKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,placeKeywords"/>
                      </for>
                      <!-- temporal keywords -->
                      <for xpath="/metadata/dataIdInfo/tempKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,temporalKeywords"/>
                      </for>
                      <!-- discipline keywords -->
                      <for xpath="/metadata/dataIdInfo/discKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,disciplineKeywords"/>
                      </for>
                      <!-- stratum keywords -->
                      <for xpath="/metadata/dataIdInfo/stratKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,stratumKeywords"/>
                      </for>
                      <!-- other keywords -->
                      <for xpath="/metadata/dataIdInfo/otherKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,otherKeywords"/>
                      </for>
                      <!-- product keywords -->
                      <for xpath="/metadata/dataIdInfo/productKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,productKeywords"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//thesaName/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//thesaName/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//thesaName//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//thesaName[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//thesaName//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <for xpath="//thesaName//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DatasetCitation">
                    <validation>

                      <!-- citation -->
                      <!-- title and date required for main citation and identifier citation -->
                      <for xpath="//idCitation[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//idCitation//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//idCitation/citId[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation identifier authority citation -->
                      <for xpath="//idCitation/citId/identAuth[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!-- identifier citation contacts -->
                      <!-- contact name, org or role -->
                      <for xpath="//idCitation/citId/identAuth/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//idCitation/citId/identAuth/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceCitationContacts">
                    <validation>

                      <!-- contact name, org or role -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ContactManager"></page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Locales">
                    <validation>
                      <!-- language is required for all locales -->
                      <for xpath="/metadata/Esri/locales/locale">
                        <exists xpath=".[@language != '']" ref="language"/>
                      </for>
                    </validation>
                  </page>
                </section>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Metadata">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataDetails">
                    <validation>

                      <!-- language is required for all iso styles -->
                      <exists xpath="/metadata/mdLang/languageCode[@value != '']" ref="languageCode"/>

                      <!-- if the level code is not 'dataset', then level name is required -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value != '005' and mdHrLv/ScopeCd/@value != '']">
                        <exists xpath="/metadata/mdHrLvName[. != '']" ref="mdHrLvName"/>
                      </for>

                      <!-- date stamp is required -->
                      <exists xpath="/metadata/mdDateSt[. != '']" ref="mdDateSt"/>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataContacts">
                    <validation>

                      <!-- one contact requried -->
                      <exists xpath="/metadata[mdContact]" ref="mdContact"/>

                      <!-- contact name, org or role -->
                      <for xpath="//mdContact">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//mdContact/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataMaintenance">
                    <validation>

                      <for xpath="//mdMaint">

                        <!-- maintentance frequency -->
                        <for xpath="maintFreq">
                          <exists xpath="MaintFreqCd[@value != '']" ref="maintFreq"/>
                        </for>

                        <!-- maintenance scope -->
                        <for xpath="maintScp">
                          <exists xpath="ScopeCd[@value != '']" ref="scopeCd"/>
                        </for>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//mdMaint/maintCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//mdMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>

                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataConstraints">
                    <validation>
                      <!-- classification code -->
                      <for xpath="//mdConst/SecConsts">
                        <exists xpath="class/ClasscationCd[@value != '']" ref="ClasscationCd"/>
                      </for>
                      <!-- if the 'other contraints' code is used, then the other contraints tag is required -->
                      <for xpath="//mdConst/LegConsts[*/RestrictCd/@value = '008']">
                        <exists xpath="othConsts[. != '']" ref="othConsts"/>
                      </for>
                      <!-- use constraint is required in the general class -->
                      <for xpath="//mdConst/Consts">
                        <exists xpath="useLimit[. != '']" ref="useLimit"/>
                      </for>
                    </validation>
                  </page>
                </section>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Resource">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceDetails">
                    <validation>

                      <!-- language of the dataset is mandatory as long as the hierarchy level code != service -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value != '014']">
                        <exists xpath="//dataIdInfo/dataLang/languageCode[@value != '']" ref="languageCode"/>
                      </for>

                      <!-- scale -->
                      <for xpath="//dataIdInfo//scaleDist[value != '']">
                        <exists xpath="value[@uom != '']" ref="uom,@uom"/>
                      </for>

                      <!-- format name and version -->
                      <for xpath="//dsFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>

                      <!-- browse file name -->
                      <for xpath="//graphOver">
                        <exists xpath="bgFileName[. != '']" ref="bgFileName"/>
                      </for>

                      <!-- spec usage -->
                      <for xpath="//idSpecUse">
                        <exists xpath="specUsage[. != '']" ref="specUsage"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//idSpecUse/usrCntInfo">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//idSpecUse/usrCntInfo/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceExtent">
                    <validation>

                      <!-- either a bounding box or a geographic description (identifier) must be provided if the item's hierarchy level is "dataset" -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '005']">
                        <or ref="dataExtReq">
                          <exists xpath="//dataExt//GeoBndBox[*]"/>
                          <exists xpath="//dataExt//GeoDesc/geoId/identCode[ . != '']"/>
                        </or>
                      </for>

                      <for xpath="//dataExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//dataExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>
                      <for xpath="//dataExt//vertEle[* != '']">
                        <exists xpath="self::*[vertMinVal &lt; vertMaxVal]" ref="vertMinMaxVal vertMinVal,vertMinVal vertMaxVal,vertMaxVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//dataExt//GeoDesc//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataExt//GeoDesc//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//dataExt//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//dataExt//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dataExt//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourcePoc">
                    <validation>

                      <!-- contact name, org or role -->
                      <for xpath="//dataIdInfo/idPoC">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataIdInfo/idPoC/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceMaintenance">
                    <validation>

                      <for xpath="//resMaint">

                        <!-- maintentance frequency -->
                        <for xpath="maintFreq">
                          <exists xpath="MaintFreqCd[@value != '']" ref="maintFreq"/>
                        </for>

                        <!-- maintenance scope -->
                        <for xpath="maintScp">
                          <exists xpath="ScopeCd[@value != '']" ref="scopeCd"/>
                        </for>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//resMaint/maintCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//resMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceConstraints">
                    <validation>
                      <!-- classification code -->
                      <for xpath="//resConst/SecConsts">
                        <exists xpath="class/ClasscationCd[@value != '']" ref="ClasscationCd"/>
                      </for>
                      <!-- if the 'other contraints' code is used, then the other contraints tag is required -->
                      <for xpath="//resConst/LegConsts[*/RestrictCd/@value = '008']">
                        <exists xpath="othConsts[. != '']" ref="othConsts"/>
                      </for>
                      <!-- use constraint is required in the general class -->
                      <for xpath="//resConst/Consts">
                        <exists xpath="useLimit[. != '']" ref="useLimit"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ReferenceSystem">
                    <validation>
                      <!-- reference system ID -->
                      <for xpath="//RefSystem">
                        <exists xpath="refSysID/identCode[@code != '']" ref="refSysID"/>
                      </for>

                      <!-- identifier authority citation -->
                      <for xpath="//refSysInfo//identAuth[*]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!-- identifier authority citation linkage -->
                      <for xpath="//refSysInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- identifier authority citation identifier -->
                      <for xpath="//refSysInfo//identAuth/citId">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- identifier authority citation contacts -->
                      <!-- contact name, org or role -->
                      <for xpath="//refSysInfo//identAuth//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//refSysInfo//identAuth//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.SpatialRepresentation">
                    <validation>

                      <!-- dimension type -->
                      <for xpath="//axisDimension">
                        <exists xpath=".[@type != '']" ref="DimType"/>
                        <exists xpath="dimSize[. != '']" ref="dimSize"/>
                      </for>

                      <for xpath="//dimResol[value != '']">
                        <exists xpath="value[@uom != '']" ref="ValueUoMUnits"/>
                      </for>

                      <!-- point in pixel -->
                      <for xpath="//Georect[ptInPixel]">
                        <exists xpath="ptInPixel/PixOrientCd[@value != '']" ref="ptInPixel"/>
                      </for>

                      <!-- cell geometry -->
                      <for xpath="//cellGeo">
                        <exists xpath="CellGeoCd[@value != '']" ref="cellGeo"/>
                      </for>

                      <!-- feature count -->
                      <for xpath="//geometObjs">
                        <exists xpath="geoObjCnt[. != '']" ref="geoObjCnt"/>
                      </for>

                      <!-- geometric object type -->
                      <for xpath="//geoObjTyp[GeoObjTypCd]">
                        <exists xpath="GeoObjTypCd[@value != '']" ref="GeoObjTypCd"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//GridSpatRep">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//Georect">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- check point availablity -->
                      <for xpath="//Georect[chkPtAv = 'True']">
                        <exists xpath="chkPtDesc[. != '']" ref="chkPtDesc"/>
                      </for>

                      <!-- parameters -->
                      <for xpath="//Georef">
                        <exists xpath="georefPars[. != '']" ref="georefPars"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//Georef">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//spatRepInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//spatRepInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date/*[. != '']" ref="dates"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//spatRepInfo//paraCit//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//spatRepInfo//paraCit//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ContentInformation">
                    <validation>

                      <!-- content information citations -->
                      <!--  title and date required -->
                      <for xpath="//contInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources -->
                      <for xpath="//contInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!--  code required for identifiers -->
                      <for xpath="//contInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                      <!--  feature catalogue -->
                      <!--  included With dataset is mandatory -->
                      <for xpath="//FetCatDesc[incWithDS]">
                        <exists xpath="incWithDS[. != '']" ref="incWithDS"/>
                      </for>

                      <!-- citation contact name, org or role -->
                      <for xpath="//catCitation//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- citation contact linkage -->
                      <for xpath="//catCitation//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!--  coverage and image description -->
                      <!-- attribute description -->
                      <for xpath="//CovDesc">
                        <exists xpath="attDesc[. != '']" ref="attDesc"/>
                      </for>
                      <for xpath="//ImgDesc">
                        <exists xpath="attDesc[. != '']" ref="attDesc"/>
                      </for>

                      <!-- content type code -->
                      <for xpath="//contentTyp">
                        <exists xpath="ContentTypCd[@value != '']" ref="ContentTypCd"/>
                      </for>

                      <!-- sequence identifier -->
                      <for xpath="//CovDesc//RangeDim">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//CovDesc//Band">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//ImgDesc//RangeDim">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//ImgDesc//Band">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>

                      <!-- band -->
                      <for xpath="//Band[minVal != '' or maxVal != '']">
                        <exists xpath="self::*[minVal &lt; maxVal]" ref="Band,.,bandMinMax minVal,minVal maxVal,maxVal"/>
                        <exists xpath="valUnit/UOM/unitSymbol[. != '']" ref="uom"/>
                      </for>

                      <!--  image description identifiers -->
                      <!-- citation contact name, org or role -->
                      <for xpath="//ImgDesc//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- citation contact linkage -->
                      <for xpath="//ImgDesc//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DataQuality">
                    <validation>

                      <!-- data quality report type -->
                      <for xpath="//dqInfo/report">
                        <exists xpath=".[@type != '']" ref="ReportType"/>
                      </for>

                      <!-- scope level is required -->
                      <for xpath="//dqInfo">
                        <exists xpath="dqScope/scpLvl/ScopeCd[@value != '']" ref="scopeCd"/>
                      </for>

                      <!-- if scope does not equal "dataset" or "series", then a Level Description is required -->
                      <for xpath="//dqInfo/dqScope[scpLvl/ScopeCd/@value != '005' and scpLvl/ScopeCd/@value != '006' and scpLvl/ScopeCd/@value != '']">
                        <exists xpath="scpLvlDesc[.//* != '']" ref="scpLvlDesc"/>
                      </for>

                      <!-- either lineage information or a data quality report must be provided for datasets -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005']">
                        <or ref="datasetReq">
                          <exists xpath="dataLineage[.//* !='']"/>
                          <exists xpath="report[.//*  !='']"/>
                          <exists xpath="report[descendant-or-self::*/@code !='' or descendant-or-self::*/@value !='' or descendant-or-self::*/@type !='']"/>
                        </or>
                      </for>

                      <!-- within the report section, either a conformance result or a quantitative result must be provided -->
                      <for xpath="//dqInfo/report">
                        <or ref="reportReq">
                          <exists xpath="measResult/ConResult//*[ . != '']"/>
                          <exists xpath="measResult/QuanResult//*[ . != '']"/>
                        </or>
                      </for>

                      <!-- within the conformance result section, all of its elements are mandatory -->
                      <for xpath="//dqInfo/report/measResult/ConResult">
                        <exists xpath="conExpl[ . != '']" ref="conExpl"/>
                        <exists xpath="conSpec[ descendant::* != '']" ref="conSpec"/>
                        <exists xpath="conPass[ . != '']" ref="conPass"/>
                      </for>

                      <!-- within the Quantitative Result section, a value and a unit of measure are required. -->
                      <for xpath="//dqInfo/report/measResult/QuanResult">
                        <exists xpath="quanValUnit/UOM/unitSymbol[ .!= '']" ref="uom"/>
                      </for>
                      <for xpath="//dqInfo/report/measResult/QuanResult/quanVal">
                        <exists xpath="self::*[ . != '']" ref="quanVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//report//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//report//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//dqInfo/report//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dqInfo/report//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- identifier -->
                      <for xpath="//dqInfo/report//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                      <!-- bounding box -->
                      <for xpath="//scpExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//scpExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//scpExt//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//scpExt//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.LI_Lineage">
                    <validation>

                      <!-- if scope = "dataset" or "series", one of process step, data source, or lineage statement is required -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']">
                        <exists xpath=".//*[ . != '']" ref="dqInfo"/>
                      </for>
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']">
                        <for xpath="dataLineage">
                          <or ref="dataLineage">
                            <exists xpath="statement[. != '']"/>
                            <exists xpath="dataSource/*[. != '']"/>
                            <exists xpath="prcStep/*[. != '']"/>
                          </or>
                        </for>
                      </for>

                      <!-- either lineage information or a data quality report must be provided for datasets -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005']">
                        <or ref="datasetReq">
                          <exists xpath="dataLineage[.//* !='']"/>
                          <exists xpath="report[.//*  !='']"/>
                          <exists xpath="report[descendant-or-self::*/@code !='' or descendant-or-self::*/@value !='' or descendant-or-self::*/@type !='']"/>
                        </or>
                      </for>

                      <!-- process step description -->
                      <for xpath="//prcStep">
                        <exists xpath="stepDesc[. != '']" ref="stepDesc"/>
                      </for>

                      <!-- Within data source, either an extent or a description must be provided -->
                      <for xpath="//dqInfo/dataLineage/dataSource">
                        <or ref="dataSource">
                          <exists xpath="srcDesc[. != '']"/>
                          <exists xpath="srcExt/*[. != '']"/>
                        </or>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//prcStep/stepProc">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//prcStep/stepProc/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//dataLineage//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataLineage//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- bounding box -->
                      <for xpath="//srcExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//srcExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>

                      <!-- data source referense system -->
                      <for xpath="//dataLineage//srcRefSys[identCode]">
                        <exists xpath="identCode[@code != '']" ref="identCode"/>
                      </for>

                      <!-- citations -->
                      <for xpath="//dataLineage//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dataLineage//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- identifiers -->
                      <for xpath="//dataLineage//*[identCode and not(identCode/@code)]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DistributionInfo">
                    <validation>

                      <!-- format name and version -->
                      <for xpath="//distFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>
                      <for xpath="//distorFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>

                      <!-- if a density value is provided, the density units is mandatory -->
                      <for xpath="//offLineMed[medDensity != '']">
                        <exists xpath="medDenUnits[. != '']" ref="medDenUnits"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//distributor/distorCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//distributor/distorCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//distInfo//onLineSrc">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.EntityAttributeInfo">
                    <validation>

                      <!-- codeset domains -->
                      <for xpath="//codesetd">
                        <exists xpath="codesetn[. != '']" ref="codesetn"/>
                        <exists xpath="codesets[. != '']" ref="codesets"/>
                      </for>

                      <!-- enumerated domains -->
                      <for xpath="//edom">
                        <exists xpath="edomv[. != '']" ref="edomv"/>
                        <exists xpath="edomvd[. != '']" ref="edomvd"/>
                        <exists xpath="edomvds[. != '']" ref="edomvds"/>
                      </for>

                      <!-- range domains -->
                      <for xpath="//rdom">
                        <exists xpath="rdommin[. != '']" ref="rdommin"/>
                        <exists xpath="rdommax[. != '']" ref="rdommax"/>
                        <exists xpath=".[rdommin &lt; rdommax]" ref="rdommin,rdommin,rdommin_range"/>
                      </for>

                      <!-- entity type -->
                      <for xpath="//enttyp">
                        <exists xpath="enttypd[. != '']" ref="enttypd"/>
                        <exists xpath="enttypds[. != '']" ref="enttypds"/>
                        <!-- entity type label -->
                        <exists xpath="enttypl[. != '']" ref="enttypl"/>
                      </for>

                      <!-- attribute label -->
                      <for xpath="//attr">
                        <exists xpath="attrlabl[. != '']" ref="attrlabl"/>

                        <!-- attribute definition -->
                        <exists xpath="attrdef[. != '']" ref="attrdef"/>

                        <!-- attribute source -->
                        <exists xpath="attrdefs[. != '']" ref="attrdefs"/>

                        <!-- TODO: not working / attribute type -->
                        <exists xpath="attrtype[. != '']" ref="attrtype"/>

                        <!-- TODO: not working / attribute width -->
                        <exists xpath="attwidth[. != '']" ref="attwidth"/>
                      </for>

                      <for xpath="/metadata/eainfo/detailed/attr">
                        <exists xpath="attrdomv[count(edom | rdom | codesetd | udom) = 1]" ref="attrdomv"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.References">
                    <validation>

                      <!-- aggregate resource -->
                      <!-- association type required under aggregate information -->
                      <for xpath="//aggrInfo/assocType">
                        <exists xpath="AscTypeCd[@value != '']" ref="AscTypeCd"/>
                      </for>
                      <!-- either a citation or an identifier for the aggregate resource must be provided -->
                      <for xpath="//aggrInfo">
                        <or ref="aggrInfo">
                          <exists xpath="aggrDSIdent/identCode[. !='']"/>
                          <exists xpath="aggrDSName//*[. !='']"/>
                        </or>
                      </for>
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//aggrInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//aggrInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//aggrInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//aggrInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//aggrInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- portrayal catalogue  -->
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//porCatInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//porCatInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//porCatInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//porCatInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//porCatInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- application schema -->
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//appSchInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//appSchInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//appSchInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//appSchInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//appSchInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.GeoprocessingHistory"></page>
                </section>
              </forms>
            </editor>
          </metadataConfig>
        </content>
      </insertComponent>
      <insertComponent id="esri_metadata_metadataEditor_iso19139" className="ISO19139MetadataEditor">
        <content type="ISO19139" displayName="ISO 19139 Metadata Implementation Specification">
          <metadataConfig ArcGISProfile="ISO19139" ValidatePages="True">
            <validationNamespaceURI>http://www.isotc211.org/2005/gmd</validationNamespaceURI>
            <validationSchemaURL>http://www.isotc211.org/schemas/2005/gmd/metadataEntity.xsd</validationSchemaURL>
            <tranformStyle>ISO19139</tranformStyle>
            <viewerXslt>Metadata\Stylesheets\ArcGISProFull.xsl</viewerXslt>
            <editor>
              <forms>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Overview">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ItemInfo">
                    <validation>

                      <!-- title -->
                      <exists xpath="/metadata/dataIdInfo/idCitation/resTitle[. != '']" ref="resTitle"/>

                      <!-- abstract -->
                      <for xpath="/metadata[not(tool)]">
                        <exists xpath="dataIdInfo/idAbs[. != '']" ref="idAbs"/>
                      </for>

                      <!-- tool summary -->
                      <for xpath="/metadata[tool]">
                        <exists xpath="tool/summary[. != '']" ref="toolSummary"/>
                      </for>

                      <!-- tools -->
                      <for xpath="//scriptExample">
                        <exists xpath="title[. != '']" ref="scriptTitle"/>
                      </for>

                      <!-- extent -->
                      <for xpath="//dataExt//GeoBndBox[@esriExtentType = 'search' AND * != '']">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Keywords">
                    <validation>

                      <!-- topic categories required for dataset or series -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '005' or mdHrLv/ScopeCd/@value = '006']">
                        <exists xpath="//dataIdInfo/tpCatBag[*/@value='True']" ref="topics"/>
                      </for>

                      <!-- theme keywords -->
                      <for xpath="/metadata/dataIdInfo/themeKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,themeKeywords"/>
                      </for>
                      <!-- place keywords -->
                      <for xpath="/metadata/dataIdInfo/placeKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,placeKeywords"/>
                      </for>
                      <!-- temporal keywords -->
                      <for xpath="/metadata/dataIdInfo/tempKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,temporalKeywords"/>
                      </for>
                      <!-- discipline keywords -->
                      <for xpath="/metadata/dataIdInfo/discKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,disciplineKeywords"/>
                      </for>
                      <!-- stratum keywords -->
                      <for xpath="/metadata/dataIdInfo/stratKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,stratumKeywords"/>
                      </for>
                      <!-- other keywords -->
                      <for xpath="/metadata/dataIdInfo/otherKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,otherKeywords"/>
                      </for>
                      <!-- product keywords -->
                      <for xpath="/metadata/dataIdInfo/productKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,productKeywords"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//thesaName/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//thesaName/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//thesaName//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//thesaName[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//thesaName//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <for xpath="//thesaName//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DatasetCitation">
                    <validation>

                      <!-- citation -->
                      <!-- title and date required for main citation and identifier citation -->
                      <for xpath="//idCitation[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//idCitation//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//idCitation/citId[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation identifier authority citation -->
                      <for xpath="//idCitation/citId/identAuth[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!-- identifier citation contacts -->
                      <!-- contact name, org or role -->
                      <for xpath="//idCitation/citId/identAuth/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//idCitation/citId/identAuth/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceCitationContacts">
                    <validation>

                      <!-- contact name, org or role -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ContactManager"></page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Locales">
                    <validation>
                      <!-- language is required for all locales -->
                      <for xpath="/metadata/Esri/locales/locale">
                        <exists xpath=".[@language != '']" ref="language"/>
                      </for>
                    </validation>
                  </page>
                </section>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Metadata">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataDetails">
                    <validation>

                      <!-- language is required for all iso styles -->
                      <exists xpath="/metadata/mdLang/languageCode[@value != '']" ref="languageCode"/>

                      <!-- if the level code is not 'dataset', then level name is required -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value != '005' and mdHrLv/ScopeCd/@value != '']">
                        <exists xpath="/metadata/mdHrLvName[. != '']" ref="mdHrLvName"/>
                      </for>

                      <!-- date stamp is required -->
                      <exists xpath="/metadata/mdDateSt[. != '']" ref="mdDateSt"/>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataContacts">
                    <validation>

                      <!-- one contact requried -->
                      <exists xpath="/metadata[mdContact]" ref="mdContact"/>

                      <!-- contact name, org or role -->
                      <for xpath="//mdContact">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//mdContact/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataMaintenance">
                    <validation>

                      <for xpath="//mdMaint">

                        <!-- maintentance frequency -->
                        <for xpath="maintFreq">
                          <exists xpath="MaintFreqCd[@value != '']" ref="maintFreq"/>
                        </for>

                        <!-- maintenance scope -->
                        <for xpath="maintScp">
                          <exists xpath="ScopeCd[@value != '']" ref="scopeCd"/>
                        </for>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//mdMaint/maintCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//mdMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>

                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataConstraints">
                    <validation>
                      <!-- classification code -->
                      <for xpath="//mdConst/SecConsts">
                        <exists xpath="class/ClasscationCd[@value != '']" ref="ClasscationCd"/>
                      </for>
                      <!-- if the 'other contraints' code is used, then the other contraints tag is required -->
                      <for xpath="//mdConst/LegConsts[*/RestrictCd/@value = '008']">
                        <exists xpath="othConsts[. != '']" ref="othConsts"/>
                      </for>
                      <!-- use constraint is required in the general class -->
                      <for xpath="//mdConst/Consts">
                        <exists xpath="useLimit[. != '']" ref="useLimit"/>
                      </for>
                    </validation>
                  </page>
                </section>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Resource">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceDetails">
                    <validation>

                      <!-- language of the dataset is mandatory as long as the hierarchy level code != service -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value != '014']">
                        <exists xpath="//dataIdInfo/dataLang/languageCode[@value != '']" ref="languageCode"/>
                      </for>

                      <!-- scale -->
                      <for xpath="//dataIdInfo//scaleDist[value != '']">
                        <exists xpath="value[@uom != '']" ref="uom,@uom"/>
                      </for>

                      <!-- format name and version -->
                      <for xpath="//dsFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>

                      <!-- browse file name -->
                      <for xpath="//graphOver">
                        <exists xpath="bgFileName[. != '']" ref="bgFileName"/>
                      </for>

                      <!-- spec usage -->
                      <for xpath="//idSpecUse">
                        <exists xpath="specUsage[. != '']" ref="specUsage"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//idSpecUse/usrCntInfo">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//idSpecUse/usrCntInfo/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceExtent">
                    <validation>

                      <!-- either a bounding box or a geographic description (identifier) must be provided if the item's hierarchy level is "dataset" -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '005']">
                        <or ref="dataExtReq">
                          <exists xpath="//dataExt//GeoBndBox[*]"/>
                          <exists xpath="//dataExt//GeoDesc/geoId/identCode[ . != '']"/>
                        </or>
                      </for>

                      <for xpath="//dataExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//dataExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>
                      <for xpath="//dataExt//vertEle[* != '']">
                        <exists xpath="self::*[vertMinVal &lt; vertMaxVal]" ref="vertMinMaxVal vertMinVal,vertMinVal vertMaxVal,vertMaxVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//dataExt//GeoDesc//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataExt//GeoDesc//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//dataExt//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//dataExt//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dataExt//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourcePoc">
                    <validation>

                      <!-- contact name, org or role -->
                      <for xpath="//dataIdInfo/idPoC">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataIdInfo/idPoC/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceMaintenance">
                    <validation>

                      <for xpath="//resMaint">

                        <!-- maintentance frequency -->
                        <for xpath="maintFreq">
                          <exists xpath="MaintFreqCd[@value != '']" ref="maintFreq"/>
                        </for>

                        <!-- maintenance scope -->
                        <for xpath="maintScp">
                          <exists xpath="ScopeCd[@value != '']" ref="scopeCd"/>
                        </for>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//resMaint/maintCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//resMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceConstraints">
                    <validation>
                      <!-- classification code -->
                      <for xpath="//resConst/SecConsts">
                        <exists xpath="class/ClasscationCd[@value != '']" ref="ClasscationCd"/>
                      </for>
                      <!-- if the 'other contraints' code is used, then the other contraints tag is required -->
                      <for xpath="//resConst/LegConsts[*/RestrictCd/@value = '008']">
                        <exists xpath="othConsts[. != '']" ref="othConsts"/>
                      </for>
                      <!-- use constraint is required in the general class -->
                      <for xpath="//resConst/Consts">
                        <exists xpath="useLimit[. != '']" ref="useLimit"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ReferenceSystem">
                    <validation>
                      <!-- reference system ID -->
                      <for xpath="//RefSystem">
                        <exists xpath="refSysID/identCode[@code != '']" ref="refSysID"/>
                      </for>

                      <!-- identifier authority citation -->
                      <for xpath="//refSysInfo//identAuth[*]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!-- identifier authority citation linkage -->
                      <for xpath="//refSysInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- identifier authority citation identifier -->
                      <for xpath="//refSysInfo//identAuth/citId">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- identifier authority citation contacts -->
                      <!-- contact name, org or role -->
                      <for xpath="//refSysInfo//identAuth//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//refSysInfo//identAuth//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.SpatialRepresentation">
                    <validation>

                      <!-- dimension type -->
                      <for xpath="//axisDimension">
                        <exists xpath=".[@type != '']" ref="DimType"/>
                        <exists xpath="dimSize[. != '']" ref="dimSize"/>
                      </for>

                      <for xpath="//dimResol[value != '']">
                        <exists xpath="value[@uom != '']" ref="ValueUoMUnits"/>
                      </for>

                      <!-- point in pixel -->
                      <for xpath="//Georect[ptInPixel]">
                        <exists xpath="ptInPixel/PixOrientCd[@value != '']" ref="ptInPixel"/>
                      </for>

                      <!-- cell geometry -->
                      <for xpath="//cellGeo">
                        <exists xpath="CellGeoCd[@value != '']" ref="cellGeo"/>
                      </for>

                      <!-- feature count -->
                      <for xpath="//geometObjs">
                        <exists xpath="geoObjCnt[. != '']" ref="geoObjCnt"/>
                      </for>

                      <!-- geometric object type -->
                      <for xpath="//geoObjTyp[GeoObjTypCd]">
                        <exists xpath="GeoObjTypCd[@value != '']" ref="GeoObjTypCd"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//GridSpatRep">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//Georect">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- check point availablity -->
                      <for xpath="//Georect[chkPtAv = 'True']">
                        <exists xpath="chkPtDesc[. != '']" ref="chkPtDesc"/>
                      </for>

                      <!-- parameters -->
                      <for xpath="//Georef">
                        <exists xpath="georefPars[. != '']" ref="georefPars"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//Georef">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//spatRepInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//spatRepInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date/*[. != '']" ref="dates"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//spatRepInfo//paraCit//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//spatRepInfo//paraCit//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ContentInformation">
                    <validation>

                      <!-- content information citations -->
                      <!--  title and date required -->
                      <for xpath="//contInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources -->
                      <for xpath="//contInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!--  code required for identifiers -->
                      <for xpath="//contInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                      <!--  feature catalogue -->
                      <!--  included With dataset is mandatory -->
                      <for xpath="//FetCatDesc[incWithDS]">
                        <exists xpath="incWithDS[. != '']" ref="incWithDS"/>
                      </for>

                      <!-- citation contact name, org or role -->
                      <for xpath="//catCitation//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- citation contact linkage -->
                      <for xpath="//catCitation//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!--  coverage and image description -->
                      <!-- attribute description -->
                      <for xpath="//CovDesc">
                        <exists xpath="attDesc[. != '']" ref="attDesc"/>
                      </for>
                      <for xpath="//ImgDesc">
                        <exists xpath="attDesc[. != '']" ref="attDesc"/>
                      </for>

                      <!-- content type code -->
                      <for xpath="//contentTyp">
                        <exists xpath="ContentTypCd[@value != '']" ref="ContentTypCd"/>
                      </for>

                      <!-- sequence identifier -->
                      <for xpath="//CovDesc//RangeDim">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//CovDesc//Band">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//ImgDesc//RangeDim">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//ImgDesc//Band">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>

                      <!-- band -->
                      <for xpath="//Band[minVal != '' or maxVal != '']">
                        <exists xpath="self::*[minVal &lt; maxVal]" ref="Band,.,bandMinMax minVal,minVal maxVal,maxVal"/>
                        <exists xpath="valUnit/UOM/unitSymbol[. != '']" ref="uom"/>
                      </for>

                      <!--  image description identifiers -->
                      <!-- citation contact name, org or role -->
                      <for xpath="//ImgDesc//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- citation contact linkage -->
                      <for xpath="//ImgDesc//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DataQuality">
                    <validation>

                      <!-- data quality report type -->
                      <for xpath="//dqInfo/report">
                        <exists xpath=".[@type != '']" ref="ReportType"/>
                      </for>

                      <!-- scope level is required -->
                      <for xpath="//dqInfo">
                        <exists xpath="dqScope/scpLvl/ScopeCd[@value != '']" ref="scopeCd"/>
                      </for>

                      <!-- if scope does not equal "dataset" or "series", then a Level Description is required -->
                      <for xpath="//dqInfo/dqScope[scpLvl/ScopeCd/@value != '005' and scpLvl/ScopeCd/@value != '006' and scpLvl/ScopeCd/@value != '']">
                        <exists xpath="scpLvlDesc[.//* != '']" ref="scpLvlDesc"/>
                      </for>

                      <!-- either lineage information or a data quality report must be provided for datasets -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005']">
                        <or ref="datasetReq">
                          <exists xpath="dataLineage[.//* !='']"/>
                          <exists xpath="report[.//*  !='']"/>
                          <exists xpath="report[descendant-or-self::*/@code !='' or descendant-or-self::*/@value !='' or descendant-or-self::*/@type !='']"/>
                        </or>
                      </for>

                      <!-- within the report section, either a conformance result or a quantitative result must be provided -->
                      <for xpath="//dqInfo/report">
                        <or ref="reportReq">
                          <exists xpath="measResult/ConResult//*[ . != '']"/>
                          <exists xpath="measResult/QuanResult//*[ . != '']"/>
                        </or>
                      </for>

                      <!-- within the conformance result section, all of its elements are mandatory -->
                      <for xpath="//dqInfo/report/measResult/ConResult">
                        <exists xpath="conExpl[ . != '']" ref="conExpl"/>
                        <exists xpath="conSpec[ descendant::* != '']" ref="conSpec"/>
                        <exists xpath="conPass[ . != '']" ref="conPass"/>
                      </for>

                      <!-- within the Quantitative Result section, a value and a unit of measure are required. -->
                      <for xpath="//dqInfo/report/measResult/QuanResult">
                        <exists xpath="quanValUnit/UOM/unitSymbol[ .!= '']" ref="uom"/>
                      </for>
                      <for xpath="//dqInfo/report/measResult/QuanResult/quanVal">
                        <exists xpath="self::*[ . != '']" ref="quanVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//report//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//report//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//dqInfo/report//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dqInfo/report//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- identifier -->
                      <for xpath="//dqInfo/report//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                      <!-- bounding box -->
                      <for xpath="//scpExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//scpExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//scpExt//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//scpExt//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.LI_Lineage">
                    <validation>

                      <!-- if scope = "dataset" or "series", one of process step, data source, or lineage statement is required -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']">
                        <exists xpath=".//*[ . != '']" ref="dqInfo"/>
                      </for>
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']">
                        <for xpath="dataLineage">
                          <or ref="dataLineage">
                            <exists xpath="statement[. != '']"/>
                            <exists xpath="dataSource/*[. != '']"/>
                            <exists xpath="prcStep/*[. != '']"/>
                          </or>
                        </for>
                      </for>

                      <!-- either lineage information or a data quality report must be provided for datasets -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005']">
                        <or ref="datasetReq">
                          <exists xpath="dataLineage[.//* !='']"/>
                          <exists xpath="report[.//*  !='']"/>
                          <exists xpath="report[descendant-or-self::*/@code !='' or descendant-or-self::*/@value !='' or descendant-or-self::*/@type !='']"/>
                        </or>
                      </for>

                      <!-- process step description -->
                      <for xpath="//prcStep">
                        <exists xpath="stepDesc[. != '']" ref="stepDesc"/>
                      </for>

                      <!-- Within data source, either an extent or a description must be provided -->
                      <for xpath="//dqInfo/dataLineage/dataSource">
                        <or ref="dataSource">
                          <exists xpath="srcDesc[. != '']"/>
                          <exists xpath="srcExt/*[. != '']"/>
                        </or>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//prcStep/stepProc">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//prcStep/stepProc/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//dataLineage//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataLineage//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- bounding box -->
                      <for xpath="//srcExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//srcExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>

                      <!-- data source referense system -->
                      <for xpath="//dataLineage//srcRefSys[identCode]">
                        <exists xpath="identCode[@code != '']" ref="identCode"/>
                      </for>

                      <!-- citations -->
                      <for xpath="//dataLineage//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dataLineage//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- identifiers -->
                      <for xpath="//dataLineage//*[identCode and not(identCode/@code)]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DistributionInfo">
                    <validation>

                      <!-- format name and version -->
                      <for xpath="//distFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>
                      <for xpath="//distorFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>

                      <!-- if a density value is provided, the density units is mandatory -->
                      <for xpath="//offLineMed[medDensity != '']">
                        <exists xpath="medDenUnits[. != '']" ref="medDenUnits"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//distributor/distorCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//distributor/distorCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//distInfo//onLineSrc">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.EntityAttributeInfo">
                    <validation>

                      <!-- codeset domains -->
                      <for xpath="//codesetd">
                        <exists xpath="codesetn[. != '']" ref="codesetn"/>
                        <exists xpath="codesets[. != '']" ref="codesets"/>
                      </for>

                      <!-- enumerated domains -->
                      <for xpath="//edom">
                        <exists xpath="edomv[. != '']" ref="edomv"/>
                        <exists xpath="edomvd[. != '']" ref="edomvd"/>
                        <exists xpath="edomvds[. != '']" ref="edomvds"/>
                      </for>

                      <!-- range domains -->
                      <for xpath="//rdom">
                        <exists xpath="rdommin[. != '']" ref="rdommin"/>
                        <exists xpath="rdommax[. != '']" ref="rdommax"/>
                        <exists xpath=".[rdommin &lt; rdommax]" ref="rdommin,rdommin,rdommin_range"/>
                      </for>

                      <!-- entity type -->
                      <for xpath="//enttyp">
                        <exists xpath="enttypd[. != '']" ref="enttypd"/>
                        <exists xpath="enttypds[. != '']" ref="enttypds"/>
                        <!-- entity type label -->
                        <exists xpath="enttypl[. != '']" ref="enttypl"/>
                      </for>

                      <!-- attribute label -->
                      <for xpath="//attr">
                        <exists xpath="attrlabl[. != '']" ref="attrlabl"/>

                        <!-- attribute definition -->
                        <exists xpath="attrdef[. != '']" ref="attrdef"/>

                        <!-- attribute source -->
                        <exists xpath="attrdefs[. != '']" ref="attrdefs"/>

                        <!-- TODO: not working / attribute type -->
                        <exists xpath="attrtype[. != '']" ref="attrtype"/>

                        <!-- TODO: not working / attribute width -->
                        <exists xpath="attwidth[. != '']" ref="attwidth"/>
                      </for>

                      <for xpath="/metadata/eainfo/detailed/attr">
                        <exists xpath="attrdomv[count(edom | rdom | codesetd | udom) = 1]" ref="attrdomv"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.References">
                    <validation>

                      <!-- aggregate resource -->
                      <!-- association type required under aggregate information -->
                      <for xpath="//aggrInfo/assocType">
                        <exists xpath="AscTypeCd[@value != '']" ref="AscTypeCd"/>
                      </for>
                      <!-- either a citation or an identifier for the aggregate resource must be provided -->
                      <for xpath="//aggrInfo">
                        <or ref="aggrInfo">
                          <exists xpath="aggrDSIdent/identCode[. !='']"/>
                          <exists xpath="aggrDSName//*[. !='']"/>
                        </or>
                      </for>
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//aggrInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//aggrInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//aggrInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//aggrInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//aggrInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- portrayal catalogue  -->
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//porCatInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//porCatInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//porCatInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//porCatInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//porCatInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- application schema -->
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//appSchInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//appSchInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//appSchInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//appSchInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//appSchInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.GeoprocessingHistory"></page>
                </section>
              </forms>
            </editor>
          </metadataConfig>
        </content>
      </insertComponent>
      <insertComponent id="esri_metadata_metadataEditor_itemDescription" className="ItemDescriptionMetadataEditor">
        <content type="ItemDescription" displayName="Item Description">
          <metadataConfig ArcGISProfile="ItemDescription" ValidatePages="True">
            <validationNamespaceURI></validationNamespaceURI>
            <validationSchemaURL></validationSchemaURL>
            <tranformXslt>ArcGIS_2ISO19139gml321.xslt</tranformXslt>
            <viewerXslt>Metadata\Stylesheets\ArcGISPro.xsl</viewerXslt>
            <editor hideSidebar="True">
              <forms>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Overview">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ItemInfo">
                    <validation>

                      <!-- title -->
                      <exists xpath="/metadata/dataIdInfo/idCitation/resTitle[. != '']" ref="resTitle"/>

                      <!-- summary / purpose -->
                      <for xpath="/metadata[not(tool)]">
                        <exists xpath="dataIdInfo/idPurp[. != '']" ref="idPurp"/>
                      </for>

                      <!-- search keywords -->
                      <for xpath="/metadata/dataIdInfo/searchKeys">
                        <exists xpath="bag[. != '']" ref="searchKeys"/>
                      </for>

                    </validation>
                  </page>
                </section>
              </forms>
            </editor>
          </metadataConfig>
        </content>
      </insertComponent>
      <insertComponent id="esri_metadata_metadataEditor_iso19115" className="ISO19115MetadataEditor">
        <content type="ISO19115" displayName="North American Profile of ISO19115 2003">
          <metadataConfig ArcGISProfile="NAP" ValidatePages="True">
            <validationNamespaceURI>http://www.isotc211.org/2005/gmd</validationNamespaceURI>
            <validationSchemaURL>http://www.isotc211.org/schemas/2005/gmd/metadataEntity.xsd</validationSchemaURL>
            <tranformStyle>ISO19139</tranformStyle>
            <viewerXslt>Metadata\Stylesheets\ArcGISProFull.xsl</viewerXslt>
            <editor>
              <forms>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Overview">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ItemInfo">
                    <validation>

                      <!-- title -->
                      <exists xpath="/metadata/dataIdInfo/idCitation/resTitle[. != '']" ref="resTitle"/>

                      <!-- abstract -->
                      <for xpath="/metadata[not(tool)]">
                        <exists xpath="dataIdInfo/idAbs[. != '']" ref="idAbs"/>
                      </for>

                      <!-- tool summary -->
                      <for xpath="/metadata[tool]">
                        <exists xpath="tool/summary[. != '']" ref="toolSummary"/>
                      </for>

                      <!-- tools -->
                      <for xpath="//scriptExample">
                        <exists xpath="title[. != '']" ref="scriptTitle"/>
                      </for>

                      <!-- extent -->
                      <for xpath="//dataExt//GeoBndBox[@esriExtentType = 'search' AND * != '']">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Keywords">
                    <validation>

                      <!-- topic categories required for dataset or series -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '005' or mdHrLv/ScopeCd/@value = '006']">
                        <exists xpath="//dataIdInfo/tpCatBag[*/@value='True']" ref="topics"/>
                      </for>

                      <!-- theme keywords -->
                      <for xpath="/metadata/dataIdInfo/themeKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,themeKeywords"/>
                      </for>
                      <!-- place keywords -->
                      <for xpath="/metadata/dataIdInfo/placeKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,placeKeywords"/>
                      </for>
                      <!-- temporal keywords -->
                      <for xpath="/metadata/dataIdInfo/tempKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,temporalKeywords"/>
                      </for>
                      <!-- discipline keywords -->
                      <for xpath="/metadata/dataIdInfo/discKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,disciplineKeywords"/>
                      </for>
                      <!-- stratum keywords -->
                      <for xpath="/metadata/dataIdInfo/stratKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,stratumKeywords"/>
                      </for>
                      <!-- other keywords -->
                      <for xpath="/metadata/dataIdInfo/otherKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,otherKeywords"/>
                      </for>
                      <!-- product keywords -->
                      <for xpath="/metadata/dataIdInfo/productKeys">
                        <exists xpath="bag[. != '']" ref="bag,.,productKeywords"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//thesaName/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//thesaName/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//thesaName//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//thesaName[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//thesaName//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <for xpath="//thesaName//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DatasetCitation">
                    <validation>

                      <!-- citation -->
                      <!-- title and date required for main citation and identifier citation -->
                      <for xpath="//idCitation[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//idCitation//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//idCitation/citId[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation identifier authority citation -->
                      <for xpath="//idCitation/citId/identAuth[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!-- identifier citation contacts -->
                      <!-- contact name, org or role -->
                      <for xpath="//idCitation/citId/identAuth/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//idCitation/citId/identAuth/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceCitationContacts">
                    <validation>

                      <!-- contact name, org or role -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- NAP: protocol -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="protocol[. != '']" ref="protocol"/>
                      </for>

                      <!-- NAP: {count(phone + address + onlineResource) > 0} -->
                      <for xpath="/metadata/dataIdInfo/idCitation/citRespParty/rpCntInfo">
                        <exists xpath="(cntPhone/voiceNum | cntAddress/* | cntOnlineRes/linkage)[. != '']/.." ref="rpCntInfo_NAP_REQ voiceNum,cntPhone/voiceNum delPoint,cntAddress/* linkage,cntOnlineRes/linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ContactManager"></page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Locales">
                    <validation>
                      <!-- language is required for all locales -->
                      <for xpath="/metadata/Esri/locales/locale">
                        <exists xpath=".[@language != '']" ref="language"/>
                      </for>
                    </validation>
                  </page>
                </section>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Metadata">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataDetails">
                    <validation>

                      <!-- language is required for all iso styles -->
                      <exists xpath="/metadata/mdLang/languageCode[@value != '']" ref="languageCode"/>

                      <!-- NAP: file identifier is required -->
                      <exists xpath="/metadata/mdFileID[. != '']" ref="mdFileID"/>

                      <!-- NAP: country code is required with language -->
                      <for xpath="/metadata/mdLang[languageCode/@value != '']">
                        <exists xpath="countryCode[@value != '']" ref="countryCode"/>
                      </for>

                      <!-- NAP: hierarchy level is required -->
                      <exists xpath="/metadata/mdHrLv/ScopeCd[@value != '' ]" ref="scopeCd"/>

                      <!-- NAP: characterset is mandatory -->
                      <exists xpath="/metadata/mdChar[CharSetCd/@value = '004']" ref="mdChar,CharSetCd,mdChar_utf8"/>

                      <!-- date stamp is required -->
                      <exists xpath="/metadata/mdDateSt[. != '']" ref="mdDateSt"/>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataContacts">
                    <validation>

                      <!-- one contact requried -->
                      <exists xpath="/metadata[mdContact]" ref="mdContact"/>

                      <!-- contact name, org or role -->
                      <for xpath="//mdContact">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//mdContact/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- NAP: protocol -->
                      <for xpath="//mdContact/rpCntInfo/cntOnlineRes">
                        <exists xpath="protocol[. != '']" ref="protocol"/>
                      </for>

                      <!-- NAP: {count(phone + address + onlineResource) > 0} -->
                      <for xpath="//mdContact/rpCntInfo">
                        <exists xpath="(cntPhone/voiceNum | cntAddress/* | cntOnlineRes/linkage)[. != '']/.." ref="rpCntInfo_NAP_REQ voiceNum,cntPhone/voiceNum delPoint,cntAddress/* linkage,cntOnlineRes/linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataMaintenance">
                    <validation>

                      <for xpath="//mdMaint">

                        <!-- maintentance frequency -->
                        <for xpath="maintFreq">
                          <exists xpath="MaintFreqCd[@value != '']" ref="maintFreq"/>
                        </for>

                        <!-- maintenance scope -->
                        <for xpath="maintScp">
                          <exists xpath="ScopeCd[@value != '']" ref="scopeCd"/>
                        </for>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//mdMaint/maintCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//mdMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- NAP: protocol -->
                      <for xpath="//mdMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="protocol[. != '']" ref="protocol"/>
                      </for>

                      <!-- NAP: {count(phone + address + onlineResource) > 0} -->
                      <for xpath="//mdMaint/maintCont/rpCntInfo">
                        <exists xpath="(cntPhone/voiceNum | cntAddress/* | cntOnlineRes/linkage)[. != '']/.." ref="rpCntInfo_NAP_REQ voiceNum,cntPhone/voiceNum delPoint,cntAddress/* linkage,cntOnlineRes/linkage"/>
                      </for>

                    </validation>

                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.MetadataConstraints">
                    <validation>
                      <!-- classification code -->
                      <for xpath="//mdConst/SecConsts">
                        <exists xpath="class/ClasscationCd[@value != '']" ref="ClasscationCd"/>
                      </for>
                      <!-- if the 'other contraints' code is used, then the other contraints tag is required -->
                      <for xpath="//mdConst/LegConsts[*/RestrictCd/@value = '008']">
                        <exists xpath="othConsts[. != '']" ref="othConsts"/>
                      </for>
                      <!-- use constraint is required in the general class -->
                      <for xpath="//mdConst/Consts">
                        <exists xpath="useLimit[. != '']" ref="useLimit"/>
                      </for>
                    </validation>
                  </page>
                </section>
                <section class="ArcGIS.Desktop.Metadata.Editor.Sections.Resource">
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceDetails">
                    <validation>

                      <!-- language of the dataset is mandatory as long as the hierarchy level code != service -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value != '014']">
                        <exists xpath="//dataIdInfo/dataLang/languageCode[@value != '']" ref="languageCode"/>
                      </for>

                      <!-- scale -->
                      <for xpath="//dataIdInfo//scaleDist[value != '']">
                        <exists xpath="value[@uom != '']" ref="uom,@uom"/>
                      </for>

                      <!-- format name and version -->
                      <for xpath="//dsFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>

                      <!-- browse file name -->
                      <for xpath="//graphOver">
                        <exists xpath="bgFileName[. != '']" ref="bgFileName"/>
                      </for>

                      <!-- spec usage -->
                      <for xpath="//idSpecUse">
                        <exists xpath="specUsage[. != '']" ref="specUsage"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//idSpecUse/usrCntInfo">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//idSpecUse/usrCntInfo/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- NAP: protocol -->
                      <for xpath="//idSpecUse/usrCntInfo/rpCntInfo/cntOnlineRes">
                        <exists xpath="protocol[. != '']" ref="protocol"/>
                      </for>

                      <!-- NAP: {count(phone + address + onlineResource) > 0} -->
                      <for xpath="//idSpecUse/usrCntInfo/rpCntInfo">
                        <exists xpath="(cntPhone/voiceNum | cntAddress/* | cntOnlineRes/linkage)[. != '']/.." ref="rpCntInfo_NAP_REQ voiceNum,cntPhone/voiceNum delPoint,cntAddress/* linkage,cntOnlineRes/linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.Services">
                    <validation>

                      <!-- service validation -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '014']/dataIdInfo">
                        <exists xpath="svType/genericName[. != '']" ref="genericName"/>
                        <exists xpath="svCouplType[CouplTypCd/@value != '']" ref="svCouplType"/>
                      </for>
                      <for xpath="//svCouplType[CouplTypCd/@value = '003']">
                        <exists xpath="//svCouplRes[svOpName != '' and svResCitId/identCode != '']" ref="svCouplRes svOpName,svOpName svResCitId,svResCitId/identCode"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceExtent">
                    <validation>

                      <!-- either a bounding box or a geographic description (identifier) must be provided if the item's hierarchy level is "dataset" -->
                      <for xpath="/metadata[mdHrLv/ScopeCd/@value = '005']">
                        <or ref="dataExtReq">
                          <exists xpath="//dataExt//GeoBndBox[*]"/>
                          <exists xpath="//dataExt//GeoDesc/geoId/identCode[ . != '']"/>
                        </or>
                      </for>

                      <for xpath="//dataExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- NAP: time instants are not allowed -->
                      <for xpath="//dataExt//TempExtent">
                        <exists xpath=".[not (.//tmPosition) or .//tmPosition = '']" ref="dataExt_NAP_REQ"/>
                      </for>

                      <!-- NAP: if the resource being described is a service (hierarchyLevel is "service" or content is present in a service-specific element) 
            and if the Coupling Type code = "mixed" or "tight", either a geographic bounding box or a geographic description is required. -->
                      <for xpath="/metadata[(mdHrLv/ScopeCd/@value = '014' or .//svType//* != '' or .//svAccProps//* != '') and (.//CouplTypCd/@value = '002' or .//CouplTypCd/@value = '003')]">
                        <or ref="dataExtServiceReq">
                          <exists xpath="//dataExt//GeoBndBox[*]"/>
                          <exists xpath="//dataExt//GeoDesc/geoId/identCode[ . != '']"/>
                        </or>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//dataExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>
                      <for xpath="//dataExt//vertEle[* != '']">
                        <exists xpath="self::*[vertMinVal &lt; vertMaxVal]" ref="vertMinMaxVal vertMinVal,vertMinVal vertMaxVal,vertMaxVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//dataExt//GeoDesc//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataExt//GeoDesc//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//dataExt//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//dataExt//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dataExt//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourcePoc">
                    <validation>

                      <!-- contact name, org or role -->
                      <for xpath="//dataIdInfo/idPoC">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataIdInfo/idPoC/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- NAP: protocol -->
                      <for xpath="//dataIdInfo/idPoC/rpCntInfo/cntOnlineRes">
                        <exists xpath="protocol[. != '']" ref="protocol"/>
                      </for>

                      <!-- NAP: {count(phone + address + onlineResource) > 0} -->
                      <for xpath="//dataIdInfo/idPoC/rpCntInfo">
                        <exists xpath="(cntPhone/voiceNum | cntAddress/* | cntOnlineRes/linkage)[. != '']/.." ref="rpCntInfo_NAP_REQ voiceNum,cntPhone/voiceNum delPoint,cntAddress/* linkage,cntOnlineRes/linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceMaintenance">
                    <validation>

                      <for xpath="//resMaint">

                        <!-- maintentance frequency -->
                        <for xpath="maintFreq">
                          <exists xpath="MaintFreqCd[@value != '']" ref="maintFreq"/>
                        </for>

                        <!-- maintenance scope -->
                        <for xpath="maintScp">
                          <exists xpath="ScopeCd[@value != '']" ref="scopeCd"/>
                        </for>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//resMaint/maintCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//resMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- NAP: protocol -->
                      <for xpath="//resMaint/maintCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="protocol[. != '']" ref="protocol"/>
                      </for>

                      <!-- NAP: {count(phone + address + onlineResource) > 0} -->
                      <for xpath="//resMaint/maintCont/rpCntInfo">
                        <exists xpath="(cntPhone/voiceNum | cntAddress/* | cntOnlineRes/linkage)[. != '']/.." ref="rpCntInfo_NAP_REQ voiceNum,cntPhone/voiceNum delPoint,cntAddress/* linkage,cntOnlineRes/linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ResourceConstraints">
                    <validation>
                      <!-- classification code -->
                      <for xpath="//resConst/SecConsts">
                        <exists xpath="class/ClasscationCd[@value != '']" ref="ClasscationCd"/>
                      </for>
                      <!-- if the 'other contraints' code is used, then the other contraints tag is required -->
                      <for xpath="//resConst/LegConsts[*/RestrictCd/@value = '008']">
                        <exists xpath="othConsts[. != '']" ref="othConsts"/>
                      </for>
                      <!-- use constraint is required in the general class -->
                      <for xpath="//resConst/Consts">
                        <exists xpath="useLimit[. != '']" ref="useLimit"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ReferenceSystem">
                    <validation>

                      <!-- NAP: a reference system is mandatory if the spatial type is 001, 002, or 004 -->
                      <for xpath="//dataIdInfo/spatRpType/SpatRepTypCd[@value = '001' or @value = '002' or @value = '004']">
                        <exists xpath="//refSysInfo//refSysID" ref="RefSystem_REQ"/>
                      </for>

                      <!-- reference system ID -->
                      <for xpath="//RefSystem">
                        <exists xpath="refSysID/identCode[@code != '']" ref="refSysID"/>
                        <!-- NAP: dimension required -->
                        <exists xpath=".[@dimension != '']" ref="RefSystem"/>
                      </for>

                      <!-- identifier authority citation -->
                      <for xpath="//refSysInfo//identAuth[*]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!-- identifier authority citation linkage -->
                      <for xpath="//refSysInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- identifier authority citation identifier -->
                      <for xpath="//refSysInfo//identAuth/citId">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- identifier authority citation contacts -->
                      <!-- contact name, org or role -->
                      <for xpath="//refSysInfo//identAuth//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//refSysInfo//identAuth//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- NAP: protocol -->
                      <for xpath="//refSysInfo//identAuth//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="protocol[. != '']" ref="protocol"/>
                      </for>
                      <!-- NAP: {count(phone + address + onlineResource) > 0} -->
                      <for xpath="//refSysInfo//identAuth//citRespParty/rpCntInfo">
                        <exists xpath="(cntPhone/voiceNum | cntAddress/* | cntOnlineRes/linkage)[. != '']/.." ref="rpCntInfo_NAP_REQ voiceNum,cntPhone/voiceNum delPoint,cntAddress/* linkage,cntOnlineRes/linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.SpatialRepresentation">
                    <validation>

                      <!-- dimension type -->
                      <for xpath="//axisDimension">
                        <exists xpath=".[@type != '']" ref="DimType"/>
                        <exists xpath="dimSize[. != '']" ref="dimSize"/>
                      </for>

                      <for xpath="//dimResol[value != '']">
                        <exists xpath="value[@uom != '']" ref="ValueUoMUnits"/>
                      </for>

                      <!-- point in pixel -->
                      <for xpath="//Georect[ptInPixel]">
                        <exists xpath="ptInPixel/PixOrientCd[@value != '']" ref="ptInPixel"/>
                      </for>

                      <!-- cell geometry -->
                      <for xpath="//cellGeo">
                        <exists xpath="CellGeoCd[@value != '']" ref="cellGeo"/>
                      </for>

                      <!-- feature count -->
                      <for xpath="//geometObjs">
                        <exists xpath="geoObjCnt[. != '']" ref="geoObjCnt"/>
                      </for>

                      <!-- geometric object type -->
                      <for xpath="//geoObjTyp[GeoObjTypCd]">
                        <exists xpath="GeoObjTypCd[@value != '']" ref="GeoObjTypCd"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//GridSpatRep">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//Georect">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- check point availablity -->
                      <for xpath="//Georect[chkPtAv = 'True']">
                        <exists xpath="chkPtDesc[. != '']" ref="chkPtDesc"/>
                      </for>

                      <!-- parameters -->
                      <for xpath="//Georef">
                        <exists xpath="georefPars[. != '']" ref="georefPars"/>
                      </for>

                      <!-- number of dimensions -->
                      <for xpath="//Georef">
                        <exists xpath="numDims[. != '']" ref="numDims"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//spatRepInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//spatRepInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date/*[. != '']" ref="dates"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//spatRepInfo//paraCit//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//spatRepInfo//paraCit//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.ContentInformation">
                    <validation>

                      <!-- all content information citations -->
                      <!--  title and date required -->
                      <for xpath="//contInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources -->
                      <for xpath="//contInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!--  code required for identifiers -->
                      <for xpath="//contInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                      <!--  feature catalogue -->
                      <!--  included With dataset is mandatory -->
                      <for xpath="//FetCatDesc[incWithDS]">
                        <exists xpath="incWithDS[. != '']" ref="incWithDS"/>
                      </for>

                      <!-- citation contact name, org or role -->
                      <for xpath="//catCitation//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- citation contact linkage -->
                      <for xpath="//catCitation//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!--  coverage and image description -->
                      <!-- attribute description -->
                      <for xpath="//CovDesc">
                        <exists xpath="attDesc[. != '']" ref="attDesc"/>
                      </for>
                      <for xpath="//ImgDesc">
                        <exists xpath="attDesc[. != '']" ref="attDesc"/>
                      </for>

                      <!-- content type code -->
                      <for xpath="//contentTyp">
                        <exists xpath="ContentTypCd[@value != '']" ref="ContentTypCd"/>
                      </for>

                      <!-- sequence identifier -->
                      <for xpath="//CovDesc//RangeDim">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//CovDesc//Band">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//ImgDesc//RangeDim">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>
                      <for xpath="//ImgDesc//Band">
                        <exists xpath="seqID[aName != '' and attributeType/aName != '']" ref="seqID aName,aName attributeType,attributeType/aName"/>
                      </for>

                      <!-- band -->
                      <for xpath="//Band[minVal != '' or maxVal != '']">
                        <exists xpath="self::*[minVal &lt; maxVal]" ref="Band,.,bandMinMax minVal,minVal maxVal,maxVal"/>
                        <exists xpath="valUnit/UOM/unitSymbol[. != '']" ref="uom"/>
                      </for>

                      <!--  image description identifiers -->
                      <!-- citation contact name, org or role -->
                      <for xpath="//ImgDesc//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- citation contact linkage -->
                      <for xpath="//ImgDesc//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DataQuality">
                    <validation>

                      <!-- data quality report type -->
                      <for xpath="//dqInfo/report">
                        <exists xpath=".[@type != '']" ref="ReportType"/>
                      </for>

                      <!-- scope level is required -->
                      <for xpath="//dqInfo">
                        <exists xpath="dqScope/scpLvl/ScopeCd[@value != '']" ref="scopeCd"/>
                      </for>

                      <!-- if scope does not equal "dataset" or "series", then a Level Description is required -->
                      <for xpath="//dqInfo/dqScope[scpLvl/ScopeCd/@value != '005' and scpLvl/ScopeCd/@value != '006' and scpLvl/ScopeCd/@value != '']">
                        <exists xpath="scpLvlDesc[.//* != '']" ref="scpLvlDesc"/>
                      </for>

                      <!-- either lineage information or a data quality report must be provided for datasets -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005']">
                        <or ref="datasetReq">
                          <exists xpath="dataLineage[.//* !='']"/>
                          <exists xpath="report[.//*  !='']"/>
                          <exists xpath="report[descendant-or-self::*/@code !='' or descendant-or-self::*/@value !='' or descendant-or-self::*/@type !='']"/>
                        </or>
                      </for>

                      <!-- within the report section, either a conformance result or a quantitative result must be provided -->
                      <for xpath="//dqInfo/report">
                        <or ref="reportReq">
                          <exists xpath="measResult/ConResult//*[ . != '']"/>
                          <exists xpath="measResult/QuanResult//*[ . != '']"/>
                        </or>
                      </for>

                      <!-- within the conformance result section, all of its elements are mandatory -->
                      <for xpath="//dqInfo/report/measResult/ConResult">
                        <exists xpath="conExpl[ . != '']" ref="conExpl"/>
                        <exists xpath="conSpec[ descendant::* != '']" ref="conSpec"/>
                        <exists xpath="conPass[ . != '']" ref="conPass"/>
                      </for>

                      <!-- within the Quantitative Result section, a value and a unit of measure are required. -->
                      <for xpath="//dqInfo/report/measResult/QuanResult">
                        <exists xpath="quanValUnit/UOM/unitSymbol[ .!= '']" ref="uom"/>
                      </for>
                      <for xpath="//dqInfo/report/measResult/QuanResult/quanVal">
                        <exists xpath="self::*[ . != '']" ref="quanVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//report//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//report//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- citation -->
                      <for xpath="//dqInfo/report//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dqInfo/report//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- identifier -->
                      <for xpath="//dqInfo/report//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <for xpath="//dqInfo/scpExt//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                      <!-- bounding box -->
                      <for xpath="//scpExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//scpExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//scpExt//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//scpExt//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.LI_Lineage">
                    <validation>

                      <!-- if scope = "dataset" or "series", one of process step, data source, or lineage statement is required -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']">
                        <exists xpath=".//*[ . != '']" ref="dqInfo"/>
                      </for>
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005' or dqScope/scpLvl/ScopeCd/@value = '006']">
                        <for xpath="dataLineage">
                          <or ref="dataLineage">
                            <exists xpath="statement[. != '']"/>
                            <exists xpath="dataSource/*[. != '']"/>
                            <exists xpath="prcStep/*[. != '']"/>
                          </or>
                        </for>
                      </for>

                      <!-- either lineage information or a data quality report must be provided for datasets -->
                      <for xpath="//dqInfo[dqScope/scpLvl/ScopeCd/@value = '005']">
                        <or ref="datasetReq">
                          <exists xpath="dataLineage[.//* !='']"/>
                          <exists xpath="report[.//*  !='']"/>
                          <exists xpath="report[descendant-or-self::*/@code !='' or descendant-or-self::*/@value !='' or descendant-or-self::*/@type !='']"/>
                        </or>
                      </for>

                      <!-- process step description -->
                      <for xpath="//prcStep">
                        <exists xpath="stepDesc[. != '']" ref="stepDesc"/>
                      </for>

                      <!-- NAP: Within data source, a descripion is required AND extent or a citation must be provided -->
                      <for xpath="//dqInfo/dataLineage/dataSource">
                        <exists xpath="srcDesc[. != '']" ref="srcDesc"/>
                      </for>
                      <for xpath="//dqInfo/dataLineage/dataSource">
                        <or ref="dataSource_nap">
                          <exists xpath="srcExt/*[. != '']"/>
                          <exists xpath="srcCitatn/*[. != '']"/>
                        </or>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//prcStep/stepProc">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//prcStep/stepProc/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- NAP: protocol -->
                      <for xpath="//prcStep/stepProc/rpCntInfo/cntOnlineRes">
                        <exists xpath="protocol[. != '']" ref="protocol"/>
                      </for>

                      <!-- NAP: {count(phone + address + onlineResource) > 0} -->
                      <for xpath="//prcStep/stepProc/rpCntInfo">
                        <exists xpath="(cntPhone/voiceNum | cntAddress/* | cntOnlineRes/linkage)[. != '']/.." ref="rpCntInfo_NAP_REQ voiceNum,cntPhone/voiceNum delPoint,cntAddress/* linkage,cntOnlineRes/linkage"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//dataLineage//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- bounding box -->
                      <for xpath="//srcExt//GeoBndBox[*]">
                        <exists xpath="westBL[. != '']" ref="westBL,.,westBL"/>
                        <exists xpath="eastBL[. != '']" ref="eastBL,.,eastBL"/>
                        <exists xpath="northBL[. != '']" ref="northBL,.,northBL"/>
                        <exists xpath="southBL[. != '']" ref="southBL,.,southBL"/>
                        <exists xpath=".[westBL &lt; eastBL]" ref="westBL,westBL,westBL_range"/>
                        <exists xpath=".[southBL &lt; northBL]" ref="northBL,northBL,northBL_range"/>
                      </for>

                      <!-- vertical max and min -->
                      <for xpath="//srcExt//vertEle[*]">
                        <exists xpath="vertMinVal[. != '']" ref="vertMinVal"/>
                        <exists xpath="vertMaxVal[. != '']" ref="vertMaxVal"/>
                      </for>

                      <!-- data source referense system -->
                      <for xpath="//dataLineage//srcRefSys[identCode]">
                        <exists xpath="identCode[@code != '']" ref="identCode"/>
                      </for>

                      <!-- citations -->
                      <for xpath="//dataLineage//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <for xpath="//dataLineage//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- identifiers -->
                      <for xpath="//dataLineage//*[identCode and not(identCode/@code)]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.DistributionInfo">
                    <validation>

                      <!-- format name and version -->
                      <for xpath="//distFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>
                      <for xpath="//distorFormat">
                        <exists xpath="formatName[. != '']" ref="formatName"/>
                        <exists xpath="formatVer[. != '']" ref="formatVer"/>
                      </for>

                      <!-- if a density value is provided, the density units is mandatory -->
                      <for xpath="//offLineMed[medDensity != '']">
                        <exists xpath="medDenUnits[. != '']" ref="medDenUnits"/>
                      </for>

                      <!-- contact name, org or role -->
                      <for xpath="//distributor/distorCont">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//distributor/distorCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- linkage -->
                      <for xpath="//distInfo//onLineSrc">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- NAP: protocol -->
                      <for xpath="//distributor/distorCont/rpCntInfo/cntOnlineRes">
                        <exists xpath="protocol[. != '']" ref="protocol"/>
                      </for>

                      <!-- NAP: {count(phone + address + onlineResource) > 0} -->
                      <for xpath="//distributor/distorCont/rpCntInfo">
                        <exists xpath="(cntPhone/voiceNum | cntAddress/* | cntOnlineRes/linkage)[. != '']/.." ref="rpCntInfo_NAP_REQ voiceNum,cntPhone/voiceNum delPoint,cntAddress/* linkage,cntOnlineRes/linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.EntityAttributeInfo">
                    <validation>

                      <!-- codeset domains -->
                      <for xpath="//codesetd">
                        <exists xpath="codesetn[. != '']" ref="codesetn"/>
                        <exists xpath="codesets[. != '']" ref="codesets"/>
                      </for>

                      <!-- enumerated domains -->
                      <for xpath="//edom">
                        <exists xpath="edomv[. != '']" ref="edomv"/>
                        <exists xpath="edomvd[. != '']" ref="edomvd"/>
                        <exists xpath="edomvds[. != '']" ref="edomvds"/>
                      </for>

                      <!-- range domains -->
                      <for xpath="//rdom">
                        <exists xpath="rdommin[. != '']" ref="rdommin"/>
                        <exists xpath="rdommax[. != '']" ref="rdommax"/>
                        <exists xpath=".[rdommin &lt; rdommax]" ref="rdommin,rdommin,rdommin_range"/>
                      </for>

                      <!-- entity type -->
                      <for xpath="//enttyp">
                        <exists xpath="enttypd[. != '']" ref="enttypd"/>
                        <exists xpath="enttypds[. != '']" ref="enttypds"/>
                        <!-- entity type label -->
                        <exists xpath="enttypl[. != '']" ref="enttypl"/>
                      </for>

                      <!-- attribute label -->
                      <for xpath="//attr">
                        <exists xpath="attrlabl[. != '']" ref="attrlabl"/>

                        <!-- attribute definition -->
                        <exists xpath="attrdef[. != '']" ref="attrdef"/>

                        <!-- attribute source -->
                        <exists xpath="attrdefs[. != '']" ref="attrdefs"/>

                        <!-- TODO: not working / attribute type -->
                        <exists xpath="attrtype[. != '']" ref="attrtype"/>

                        <!-- TODO: not working / attribute width -->
                        <exists xpath="attwidth[. != '']" ref="attwidth"/>
                      </for>

                      <for xpath="/metadata/eainfo/detailed/attr">
                        <exists xpath="attrdomv[count(edom | rdom | codesetd | udom) = 1]" ref="attrdomv"/>
                      </for>
                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.References">
                    <validation>

                      <!-- aggregate resource -->
                      <!-- association type required under aggregate information -->
                      <for xpath="//aggrInfo/assocType">
                        <exists xpath="AscTypeCd[@value != '']" ref="AscTypeCd"/>
                      </for>
                      <!-- either a citation or an identifier for the aggregate resource must be provided -->
                      <for xpath="//aggrInfo">
                        <or ref="aggrInfo">
                          <exists xpath="aggrDSIdent/identCode[.!='']"/>
                          <exists xpath="aggrDSName//*[.!='']"/>
                        </or>
                      </for>
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//aggrInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//aggrInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//aggrInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//aggrInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//aggrInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- portrayal catalogue  -->
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//porCatInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//porCatInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//porCatInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//porCatInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//porCatInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                      <!-- application schema -->
                      <!-- title and date required for citation and identifier citations -->
                      <for xpath="//appSchInfo//*[resTitle | date]">
                        <exists xpath="resTitle[. != '']" ref="resTitle"/>
                        <exists xpath="date[* != '']" ref="dates createDate,createDate pubDate,pubDate reviseDate,reviseDate"/>
                      </for>
                      <!--  linkage required for online resources for main citation and identifier citation -->
                      <for xpath="//appSchInfo//citOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>
                      <!-- citation identifier -->
                      <!--  code required for identifiers -->
                      <for xpath="//appSchInfo//*[identCode]">
                        <exists xpath="identCode[. != '']" ref="identCode"/>
                      </for>
                      <!-- citation or identifier citation cited responsible party  -->
                      <!-- contact name, org or role -->
                      <for xpath="//appSchInfo//citRespParty">
                        <exists xpath="(rpIndName | rpOrgName | rpPosName)[. != '']/.." ref="party IndName,rpIndName OrgName,rpOrgName PosName,rpPosName"/>
                        <exists xpath="role[RoleCd/@value != '']" ref="role"/>
                      </for>
                      <!-- linkage -->
                      <for xpath="//appSchInfo//citRespParty/rpCntInfo/cntOnlineRes">
                        <exists xpath="linkage[. != '']" ref="linkage"/>
                      </for>

                    </validation>
                  </page>
                  <page class="ArcGIS.Desktop.Metadata.Editor.Pages.GeoprocessingHistory"></page>
                </section>
              </forms>
            </editor>
          </metadataConfig>
        </content>
      </insertComponent>
    </insertCategory>

  </categories>
  
</ArcGIS>

